
\input{settings}

%\input{stylefiles/preamble.tex}
\input{macros.tex}
\input{stylefiles/additional.tex}
\input{colors}


\input{titlepage}

%\setbeamercolor{title}{bg=snow}
%\setbeamercolor{title}{fg=darkblue}
\title{A Calculus of Complex Zonotopes for \\ Invariant and Stability Verification \\of Affine Hybrid Systems}
\setbeamercolor{author}{fg=darkblue}
\author[shortname]{ {\Large  Arvind\ Adimoolam}\vspace{-2em}}
%\setbeamercolor{institute}{fg=calpolypomonagreen}
%% \institute{
%% \center
%% \includegraphics[scale=0.15]{figures/LogoVERIMAG.png}
%% VERIMAG \includegraphics[scale=0.03]{logo-uga-vo-cmjn.jpg}
%% }


\date{}

\begin{document}
\nohyphens

% Title page
\begin{frame}[plain]
\maketitle
%
%
\begin{minipage}{1\textwidth}
\vspace{-4em}
\begin{minipage}{0.3\textwidth}
{\footnotesize {\it Reviewers}}\\
{\small Sylvie Putot\\
Mahesh Viswanathan}
\end{minipage}
%
\hspace{2em}
\begin{minipage}{0.3\textwidth}
{\footnotesize {\it Supervised by}}\\
{\small Thao Dang}
\end{minipage}
%
\begin{minipage}{0.25\textwidth}
{\footnotesize {\it Examiners}}\\
{\small Laurent Fribourg\\
Luc Jaulin}
\end{minipage}
%
\end{minipage}
%
\begin{minipage}{1\textwidth}
\vspace{0.5em}
\center
%
\begin{minipage}{0.2\textwidth}
\includegraphics[scale=0.15]{figures/LogoVERIMAG.png}
\end{minipage}
%
\begin{minipage}{0.5\textwidth}
{\footnotesize \hspace{0em}VERIMAG / University Grenoble Alpes\\
$~~~~~~~~~~~~~~~~$Grenoble, France}
\end{minipage}
%
\begin{minipage}{0.2\textwidth}
~~\includegraphics[scale=0.03]{logo-uga-vo-cmjn.jpg}
\end{minipage}
%
\end{minipage}
%
\end{frame}

%=============================================================================================================================

\begin{frame}{Hybrid Dynamics of Real World Systems}

\begin{minipage}{0.5\textwidth}
%% Signal with hybrid behavior:
%
\begin{tikzpicture}[scale = 0.6]
% Create axis
\draw[thick,->] (0,0) -- (0,5);
\draw[thick,->] (0,0) -- (6,0);

% Label axis
\node[text width = 1 cm] at (-0.8,5) {signal value};
\node[text width = 1 cm] at (6,-0.4) {time};

% Create curve 1 from t=0 to t=2
\draw[red,very thick] (0,0) parabola (2,2);
% Create curve 1 from t=2 to t=4
\draw[red,very thick] (2,2) .. controls (3,1.5) .. (4,3);
% Create curve 1 from t=4 to t=6
\draw[red,very thick] (4,2) .. controls (5,3) .. (6,5);

% Label behavior of curves

% Label switch in dynamics
\node[text width = 1.6cm, blue] at (2,4)  (switch) {{\footnotesize switch in\\ dynamics}};
\draw[ ->] (2,2) -- (switch);


% Label jump in state
\node[text width = 2.5cm, blue] at (5.5,1) (jump) {{\footnotesize jump in state}};
\draw[blue, dashed] (4,2) -- (4,3);
\draw[->] (4,2.5) -- (jump);

\end{tikzpicture}
%
\end{minipage}
\begin{minipage}{0.45\textwidth}
%% Dynamics of hybrid system
%
\begin{tikzpicture}[scale =0.8,
location/.style = {circle, draw=red!60, thick, fill = cyan!5}, 
]


% Draw locations
\node[text width = 2 cm, scale =0.8, location] at (0,0) {{ Diff. eqn.\\ \hspace{1.5em} @ $l_1$}};
\node[text width = 2 cm, scale =0.8, location] at (4,0) {{ Diff. eqn.\\  \hspace{1.5em} @ $l_2$}};

% Draw edges
\draw[thick, blue, ->] (1,0.5) --  (3,0.5);
\draw[thick, blue, <-] (1,-0.5) --  (3,-0.5);

% Label edges
\node[text width = 1cm] at (2,0.7) {\scriptsize state};
\node[text width = 1cm] at (2,0.3) {\scriptsize change};
\node[text width = 1cm] at (2,-0.3) {\scriptsize state};
\node[text width = 1cm] at (2,-0.7) {\scriptsize change};

\end{tikzpicture}\\[0.5em]
%
$x\in\reals^n$: Continuous state.\\
$l\in\set{l_1,...,l_k}$: Discrete state.
\end{minipage}

\begin{minipage}{0.45\textwidth}
\begin{figure}
\center
\includegraphics[width = 3cm, height = 3cm]{figures/downloaded/CarGear.png}
\caption{\small Gear control to switch dynamics}
\end{figure}
\end{minipage}
%
\begin{minipage}{0.45\textwidth}
\begin{figure}
\includegraphics[height = 3cm, width = 2.5cm]{figures/downloaded/ComputerControl.jpg}
\caption{\small Computer Control System}
\end{figure}
\end{minipage}

\end{frame}


%=========================================================================================================================================

\begin{frame}{Verification of Hybrid Systems is Challenging}
%
\begin{itemize}
\item For most hybrid system, computing set of reachable states is \negemph{ undecidable} or \negemph{ computationally expensive}.
{\bf TODO give references}
\item Consider a simple \negemph{ discrete time affine switched system}:
\[
x(t+1) = A_ix(t)+u_i,~~i\in\set{1,2}.
\]
%
\begin{tikzpicture}[scale = 0.8
]
\draw[fill=cyan] (0,0) circle (1cm);

\draw[rotate around = {45:(2,2)}, fill=cyan] (2,2) ellipse (0.5cm and 1cm);
\draw[rotate around = {135:(1.5,2.5)}, fill=cyan] (1.5,2.5) ellipse (0.4cm and 1.2cm);
\draw[->,thick] (0,0) -- (2,2);
\draw[->,thick] (0,0) -- (1.5,2.5);
\node[text width = 2cm] at (0.6, 2.5) {$2$ convex\\ sets};

\draw[rotate around = {30:(6,1)}, fill=cyan] (6,1) ellipse (0.5cm and 1cm);
\draw[rotate around = {120:(5.5,1.2)}, fill=cyan] (5.5,1.2) ellipse (0.4cm and 1.2cm);
\draw[rotate around = {60:(5.8,1.5)}, fill=cyan] (5.8,1.5) ellipse (0.5cm and 1cm);
\draw[rotate around = {150:(5.3,1.7)}, fill=cyan] (5.3,1.7) ellipse (0.5cm and 1cm);
\draw[->,thick] (2,2) -- (6,1);
\draw[->,thick] (2,2) -- (5.5,1.2);
\draw[->,thick] (1.5,2.5) -- (5.3,1.7);
\draw[->,thick] (1.5,2.5) -- (5.8,1.5);
\node[text width = 2cm] at (5, 2.7) {$4$ convex \\sets};

\draw[->,thick] (6,1.5) -- (9,3);
\node[text width = 2cm] at (8.5,2) {\small $n$ steps};
\node[draw,text  width = 2cm]  at (10.5,3.5) {\negemph{ $2^n$ convex\\ sets}};
\end{tikzpicture}
%
\end{itemize}
%
\end{frame}

%==========================================================================================================================

\begin{frame}{Over-approximation Using Set Representation}
To deal with \negemph{ undecidability} or \negemph{ high computational complexity} of representing reachable sets:
%
\begin{itemize}
\item \posemph{Over-approximate} them by a \posemph{ set} which can be \posemph{ encoded} and \posemph{ manipulated efficiently}.
\item use \plemph{ Set Representation}:  A \posemph{ digital encoding} of a possibly infinite \posemph{ set of states}.
\end{itemize}
%

\begin{minipage}{0.35\textwidth}
% Polytopic approximation of reachable set
\center{
\begin{tikzpicture}[scale=0.9]
\draw[rotate around = {30:(6,1)}, fill=cyan!30] (6,1) ellipse (0.5cm and 1cm);
\draw[rotate around = {120:(5.5,1.2)}, fill=cyan] (5.5,1.2) ellipse (0.4cm and 1.2cm);
\draw[rotate around = {60:(5.8,1.5)}, fill=cyan] (5.8,1.5) ellipse (0.5cm and 1cm);
\draw[rotate around = {150:(5.3,1.7)}, fill=cyan] (5.3,1.7) ellipse (0.5cm and 1cm);
% draw lines of polytope around above image
\draw[very thick,color=onyx] (4.38,0.53)--(5,2.7);
\draw[very thick,color=onyx] (5,2.7)--(5.8,2.6);
\draw[very thick,color=onyx] (5.8,2.6)--(6.6,1.75);
\draw[very thick,color=onyx] (6.6,1.75)--(6.8,0.9);
\draw[very thick,color=onyx] (6.8,0.9)--(6.575,0);
\draw[very thick,color=onyx] (6.575,0)--(4.38,0.53);
\end{tikzpicture}
}
%
\begin{exampleblock}{Polytopes}
\eqnemph{$\set{x:Tx\leq d, x\in\reals^n}$}\\
{\small $T\in\mat{m}{n}{\reals}$, ${d\in\reals^m}$.}
\end{exampleblock}
%
\end{minipage}
%
\hspace{2.5em}
\begin{minipage}{0.4\textwidth}
%
\vspace{-0.5em}
\centering{
%
\begin{tikzpicture}[scale=0.8]x
\draw[rotate around = {30:(6,1)}, fill=cyan] (6,1) ellipse (0.5cm and 1cm);
\draw[rotate around = {120:(5.5,1.2)}, fill=cyan] (5.5,1.2) ellipse (0.4cm and 1.2cm);
\draw[rotate around = {60:(5.8,1.5)}, fill=cyan] (5.8,1.5) ellipse (0.5cm and 1cm);
\draw[rotate around = {150:(5.3,1.7)}, fill=cyan] (5.3,1.7) ellipse (0.5cm and 1cm);
% draw ellipse around the above image
\draw[color=onyx, very thick, rotate around={70:(5.7,1.1)}] (5.7,1.1) ellipse (1.65cm and 1.225cm);
\end{tikzpicture}
%
}
%
\hspace{0.5em}
\begin{exampleblock}{Ellipsoid}
\eqnemph{$\set{x: x^TPx\leq 1, x\in\reals^n}$}.\\
{\small $P\in\mat{n}{n}{\reals}$: Positive semi-definite.}
\end{exampleblock}
%
\end{minipage}
%
\end{frame}

%====================================================================================================================================

\begin{frame}{Positive Invariant for Unbounded Time
Over-approximation}
Typically use \plemph{Positive Invariant} (PI) to approximate reachable
set for \posemph{unbounded/all time/s}.
%
\begin{block}{}
$\Psi: Positive Invariant\implies \forall x\in\Psi, \operatorname*{Next}(x)\in\Psi$.
\end{block}
%
\hspace{1.5em}
\begin{minipage}{0.45\textwidth}
\eqnemph{
({\small {Initial~Set}$\subseteq$ PI)$\implies$ \\(Unbounded(t) 
reach set $\subseteq$ PI).}
}
\end{minipage}
%
\begin{minipage}{0.35\textwidth}
\center{
\begin{tikzpicture}[scale=2.5]
\draw[fill=cyan] plot[smooth cycle] coordinates {(0,0) (0.5,1)
(1,1.2) (1.5,0.9) (1.2,0) };
\draw[fill=red!30] plot[smooth cycle] coordinates {(0.2,0.2) (0.5,0.8)
(1,1) (1.5,0.8) (1.2,0.2) };
\draw[->,thick] (0,0)--(0.2,0.2);
\draw[->,thick] (0.5,1)--(0.5,0.8);
\draw[->,thick] (1,1.2)--(1,1);
\draw[->,thick] (1.5,0.9) -- (1.48,0.79);
\draw[->,thick] (1.2,0)--(1.2,0.2);
\draw[fill=white] (0.5,0) rectangle (1,0.5);
\node[text width = 0.25cm] at (0.75, 0.25) {\small Init.\\ Set };
\end{tikzpicture}
}
\end{minipage}
%
\end{frame}

%=====================================================================================================================================

\begin{frame}{Desirable Features of a Set Representation}
\begin{itemize}
\item \posemph{Accurate} and \posemph{fast computation} of  reachable states $\Leftarrow$
\begin{enumerate}
\item \plemph{Closure} under set operations involved in computing reachable sets.
\item \plemph{Low computational complexity} of set operations involved in computing reachable sets.
\item \plemph{Existence} and \plemph{efficient encoding} of \plemph{positive invariants} for \plemph{stable linear transformations}.
\end{enumerate}
\end{itemize}
\pause
%
For \posemph{affine hybrid systems}, like \eqnemph{
%
\begin{align*}
& \text{if}~T_{\trj{l}{t}}\trj{x}{t}\leq 1,~~ \trj{l}{t+1}=f(\trj{l}{t})\\
& \trj{x}{t+1}=
A_{\trj{l}{t}}\trj{x}{t}+\trj{u}{t}.
\end{align*}
}
%
Set operations typically used in reachability computations:\\
\plemph{Linear transformation}, \plemph{Minkowski sum}, \plemph{Intersection with half-spaces}.
\end{frame}

%=======================================================================================================================================

\begin{frame}{Features of Polytopes and Ellipsoids}
%
\begin{minipage}{0.48\textwidth}
\underline{\plemph{Polytope}}:
\begin{enumerate}
\item \emph{Linear transformation}: \posemph{Efficient} for \posemph{invertible matrix};
\negemph{Otherwise Exponential Complexity}.
\item \emph{Minkowski sum}: More than \negemph{Exponential
Complexity}.
\item \emph{Positive Invariant}: \posemph{Exists} for stable linear
transformation, but \negemph{compleixty of encoding} is \negemph{unbounded}.
\end{enumerate}
\end{minipage}
%
\begin{minipage}{0.48\textwidth}
\underline{\plemph{Ellipsoid}}:
%
\begin{enumerate}
\item \emph{Invertible Linear transformation} is \posemph{efficiently
computable}.
\item \emph{Minkowski sum}: \negemph{Not closed}.
\item \emph{Positive Invariant}: \posemph{Exists}
and \posemph{Efficiently encodable} for stable linear transformation.
\end{enumerate}
%
\end{minipage}
%
\end{frame}

%==================================================================================================================================

\begin{frame}{Simple Zonotope}
A \plemph{zonotope} is a \plemph{projection} of \plemph{higher dimensional hypercube}
onto \plemph{lower dimensional} space.\\[0.5em]
%
Let  \emph{ $V\in\mat{n}{m}{\reals}$: Generator matrix},
 \emph{$c\in\reals^n$: center}.
 %
\begin{block}{}
\center{
\eqnemph{
$
\rztope{\ptemp}{\cen}:=\set{\cen+\ptemp\zeta:~\zeta\in[-1,1]^m}.
$
}
}
%
\end{block}
%
\vspace{0.5em}
%
\begin{minipage}{0.43\textwidth}
{\scriptsize $V=\mymatrix{1 &   -1 &          0 &    0.5 \\
   -1 &         0 &   -1 &    0.5}$}
\includegraphics[scale=0.25]{figures/CZtopes/RealZonotope.jpg}
\end{minipage}
%
\vline
%
\begin{minipage}{0.55\textwidth}
\begin{enumerate}
\item \posemph{Advantage} over \posemph{polytope} for linear transformation.
%
\eqnemph{\[
A\rztope{\ptemp}{\cen}=\rztope{A\ptemp}{A\cen}.
\]}
%
\vspace{-2em}
\item \posemph{Advantage} over \posemph{ellipsoid} and \posemph{polytope} for Minkowski sum.
%
\eqnemph{\begin{align*}
& \rztope{\ptemp}{\cen}\oplus\rztope{\ptemp^\pr}{\cen^\pr}\\
& = \rztope{\mymatrix{\ptemp & \ptemp^\pr}}{\cen+\cen^\pr}.  
\end{align*}}
%
\end{enumerate}
%
\end{minipage}
%
\end{frame}

%==================================================================================================================================


\begin{frame}{Drawback of Zonotopes for Computing Positive Invariants}
\begin{itemize}
\item \negemph{Directions for convergence} to an \negemph{equilibrium} can be
encoded by \negemph{complex valued eigenvectors}.
\item Usual \negemph{zonotopes} only have
\negemph{real eigenvectors} as \negemph{generators}.
\end{itemize}
%
\pause
%
\begin{block}{}
{\small
Let \emph{$A\in\mat{n}{n}{\reals}$} has \emph{$\mu\in[-1,1]^n$: real
eigenvalues} and \emph{$\ptemp\in\mat{n}{n}{\reals}$: eigenvectors} as
\emph{column vectors}, i.e., \emph{$A\ptemp = \ptemp\diagonal{\mu}$}.
}
\eqnemph{\[
A\lt(\rztope{\ptemp}{0}\rt)\subseteq \rztope{\ptemp}{0}
\]}
\vspace{-1em}
\end{block}
%
\negemph{*} We \negemph{can not rely} on above proposition when \negemph{eigenvectors are complex}.
\end{frame}

%==================================================================================================================================

\begin{frame}{Complex Zonotope: A New Set Representation}

{\small
\begin{itemize}
\item Extend \posemph{simple zonotope to complex numbers} in a way that can \posemph{capture
contraction along complex vectors}.
\item \plemph{Complex valued generators} with \plemph{Complex combining
coefficients} whose \plemph{absolute value $<=1$}.
\item Geometrically, \plemph{Minkowski sum} of \plemph{Ellipses}
and \plemph{Line Segments}.
\end{itemize}
%
$\ptemp\in\mat{n}{m}{\compnums}$, $\cen\in\reals^n$.
}
%
\begin{block}{}
\center{
\eqnemph{$
\cztope{\ptemp}{\cen} := \set{\ptemp\zeta+\cen:~\zeta\in\compnums^m,~\infnorm{\zeta}\leq 1}.
$}
}
\end{block}
%
\begin{minipage}{0.35\textwidth}
%
\begin{tikzpicture}[scale=1]
\node[text width = 1cm] at (0,2) {{\small $\mymatrix{1+2\iota\\1-2\iota}$}};
\draw[thick,fill=cyan, rotate around = {135:(0,0)}] (0,0) ellipse
(1cm and 0.5cm);
\draw[->] (0,1.5)--(0,0.8);
\node at (1.5,1){$\bigoplus$};
\end{tikzpicture}
%
\end{minipage}
%
\begin{minipage}{0.3\textwidth}
%
\begin{tikzpicture}[scale=0.8]
\node[text width = 1cm] at (0,3.5) {{\small $\mymatrix{1\\1}$}};
\draw[color=blue,very thick] (-0.5,0.5)--(1,2);
\draw[->] (-0.2,3)--(-0.2,1.5);
\node at (1.5,2.5){$\bigoplus$};
\end{tikzpicture}
%
\end{minipage}
%
\begin{minipage}{0.3\textwidth}
%
\begin{tikzpicture}[scale=1]
\node[text width = 1cm] at (0,2) {{\small$\mymatrix{2+\iota\\2-\iota}$}};
\draw[thick,fill=cyan, rotate around = {45:(0,0)}] (0,0) ellipse
(1cm and 0.5cm);
\draw[->] (0,1.5)--(0,0.8);
\end{tikzpicture}
%
\end{minipage}
%
\end{frame}

%==================================================================================================================================

\begin{frame}{Non-polytopic Projection of Complex Zonotope}
%
\begin{figure}
\center
\includegraphics[scale=0.3]{figures/CZtopes/xycz.png}
\includegraphics[scale=0.3]{figures/CZtopes/yzcz.png}\\
\includegraphics[scale=0.3]{figures/CZtopes/xzcz.png}
%\caption{Real projection of complex zonotope on axis oriented hyperplanes}~\label{fig:3dcztope}
\end{figure}
%
\end{frame}

%==================================================================================================================================

\begin{frame}{Contraction Along Complex Eigenvectors}

\begin{block}{}
{\small
Let \plemph{$A\ptemp = \ptemp\diagonal{\mu}$}:
$\ptemp\in\mat{n}{n}{\compnums}$ and $\mu\in\compnums^n$.
}

\begin{enumerate}
\eqnemph{
\item $A\lt(\cztope{\ptemp}{0}\rt)
= \cztope{\ptemp\diagonal{{\mu}}}{0}.$
\item If
$\infnorm{\mu}\leq 1$, then
$A\lt(\rztope{\ptemp}{0}\rt)\subseteq \rztope{\ptemp}{0}$.
}
\end{enumerate}
%
\end{block}
%
\begin{figure}
\center
\includegraphics[scale=0.25]{figures/CZtopes/eigcontraction.png}\\
\includegraphics[scale=0.25]{figures/CZtopes/contraction-zonotope.png}
%\caption{Contraction of complex zonotope along
%eigenvectors}~\label{fig:cz-scaled-down}
\end{figure}
%
\end{frame}

\begin{frame}{Problem with Refining a Complex Zonotope}
\negemph{*} \negemph{Better approximation} by complex
zonotope \negemph{can not} be found by \negemph{adding generator}.
%
\begin{enumerate}
\item \negemph{Increases size}.
\item \negemph{Distorts positive invariance}.
\end{enumerate}
%
\begin{figure}
\center
\includegraphics[scale=0.3]{figures/CZtopes/refinement.png}
%% \caption{Violation of positive invariance and size increase after
%% adding a generator to the basic representation.}~\label{fig:refinement}
\end{figure}
%
\end{frame}
%
\begin{frame}{Template Complex Zonotope}
\plemph{Variable bounds} on absolute values of \plemph{combining
coefficients}.\\[0.5em]

{\small
${\ptemp\in\mat{n}{m}{\compnums}}$: \plemph{template},
\fbox{${\sfact\in\reals^m_{\geq 0}}$: \plemph{scaling factors}},
${\cen\in\reals^n}$: \plemph{center}.
}
%
\begin{block}{}
%
\center{\eqnemph{
$
\tcztope{\ptemp}{\cen}{\sfact}
= \set{\ptemp\zeta+\cen:~\absolute{\zeta_i}\leq \sfact_i~\forall
i\in\set{1,...,m}}.
$
}}
\end{block}
%
\begin{itemize}
\item \posemph{Add more generators} and \posemph{adjust scaling} factors to find \posemph{better approximations}.
\end{itemize}
%
[TODO: ADD FIGURE HERE]\\
Similar to \posemph{template polyhedron}~{TODO: CITE REFERENCES}.
\end{frame}
%
\begin{frame}{Basic Operations: Template Complex Zonotope}
%
\begin{enumerate}
\eqnemph{
\item
$A\tcztope{\ptemp}{\cen}{\sfact}=\tcztope{A\ptemp}{A\cen}{\sfact}$.
\item $\minsum{\tcztope{\ptemp}{\cen}{\sfact}}{\tcztope{\ptemp^\pr}{\cen^\pr}{\sfact^\pr}}
= \tcztope{\begin{bmatrix}\ptemp
& \ptemp^\pr\end{bmatrix}}{\cen+\cen^\pr}{\begin{bmatrix}\sfact\\\sfact^\pr\end{bmatrix}}$.
}
\item {\small Let $\supp{v}{\Psi}=\sup_{x\in\Psi}v^Tx$}. Then \plemph{support
function}\\
\eqnemph{
\[
\supp{v}{\real\lt(\tcztope{\ptemp}{\cen}{\sfact}\rt)}=v^Tc+\absolute{v^T\ptemp}\sfact.
\]
}
\end{enumerate}
%
\begin{itemize}
\item Above are \posemph{affine functions} of \posemph{center}
and \posemph{scaling factors}.
\end{itemize}
%
\end{frame}
%
\begin{frame}{Checking Inclusion}
Generally, checking inclusion between complex zonotopes requires \negemph{non-convex
optimization}.
But we propose a \posemph{convex relaxation} that  \posemph{works well
in practice}.\\[0.5em]
%
{\small 
%
\begin{definition}[\eqnemph{$\tcztope{\ptemp^\pr}{\cen^\pr}{\sfact^\pr}\order\tcztope{\ptemp}{\cen}{\sfact}$}]
%
\vspace{-1em}
\begin{align*}
& \exists \tmat\in\mat{m}{r}{\compnums},\tvect\in\compnums^m~~\text{such
that}\\
& \ptemp\tmat=\ptemp^\pr\diagonal{\sfact^\pr},~~\ptemp\tvect=\cen^\pr-\cen~\\%\numberthis\label{eqn:inclusion-tcz1}\\
& \max_{i=1}^m\lt(\absolute{\tvect_i}+\sum_{j=1}^r\absolute{\tmat_{ij}}-\sfact_i\rt)\leq
0.
\end{align*}
%
\end{definition}
}
\vspace{0.3em}
\begin{minipage}{0.37\textwidth}
\begin{exampleblock}{}
\center{\eqnemph{Result: 
$\order\implies\subseteq$.
}}
\end{exampleblock}
\end{minipage}
%
\begin{minipage}{0.6\textwidth}
\begin{itemize}
\item $\order$: \plemph{Second order conic constraints} (convex
constraints) on \plemph{center} and \plemph{scaling factors}.
\end{itemize}
\end{minipage}
%
\end{frame}

%==================================================================================================================================

\begin{frame}{Intersection between Complex Zonotopes}

\end{frame}

%==================================================================================================================================

\begin{frame}{Intersection with Half-Space}
%
\plemph{Transitions}  {can be controlled by} \plemph{linear constraints}.  But \negemph{Not Closed}.\\[0.5em]
%
\begin{minipage}{1\textwidth}
{\small Earlier \posemph{extensions} of \posemph{real zonotope} to handle \posemph{half-space intersection}}.

\begin{itemize}
\item \plemph{Constrained Zonotope}, \plemph{Constrained Affine set}.\\[0.5em]
\item Allow \plemph{additional linear contraints} on \plemph{combining coefficients}.
\end{itemize}
%
\end{minipage}
~\\[1em]
%
{\small \negemph{Emulating} the above for complex zonotope, we get:}
\begin{minipage}{0.48\textwidth}
\eqnemph{\small
\begin{align*}
& \cztope{\mymatrix{1+2\iota & 2+\iota\\ 1-2\iota &2-\iota}}{0}
\bigcap\set{x: x\leq 0}\\[0.5em]
\hline\\[-1em]
&= \set{\begin{array}{c}
\mymatrix{1+2\iota & 2+\iota\\ 1-2\iota & 2-\iota}(\zeta+\iota\epsilon):\\
~\\[-0.5em]
\hline
\multicolumn{1}{|c|}{\zeta_i^2+\epsilon_i^2\leq 1~\forall i\in\set{1,2}}\\
\hline
~\\[-0.5em]
\hline
\multicolumn{1}{|c|}{\zeta_1+\zeta_2-2\epsilon_1+2\epsilon_2\leq 0}\\
\hline
\end{array}
}.
\end{align*}
}
\end{minipage}
%
\begin{minipage}{0.45\textwidth}
\begin{itemize}
\item Computing \negemph{support function} becomes \negemph{intractable}.
\item \negemph{Can not} find \negemph{practically useful} convex relaxation for \negemph{inclusion-checking}.
\end{itemize}
%
\end{minipage}
%
\end{frame}

%==================================================================================================================================

\begin{frame}{Special Case: Interval Zonotope and Sub-parallelotope}
%
\begin{minipage}{0.45\textwidth}
\plemph{Interval Zonotope}: {\small Representation of \plemph{real zonotope} using \plemph{{variable\\ {interval} bounds}}, no explicit center.\\[0.5em]
%
\eqnemph{${\lb,\ub}\in\reals^k:~\lb\leq \ub$}, ${\stemp\in\mat{k}{n}{\reals}}$.}
%
{\small
\begin{exampleblock}{\center{$\iztope{\stemp}{\lb}{\ub}$}}
\eqnemph{$\set{\stemp\zeta:~\zeta\in\reals^k,~\lb\leq\zeta\leq\ub}.$}
\end{exampleblock}
}
%
\end{minipage}
%
\hspace{0.25em}
\vline
\hspace{0.25em}
%
\begin{minipage}{0.45\textwidth}
\plemph{Sub-parallelotope}: {\small Represents  \\\plemph{possibly unbounded parallelotopes}.\\[0.5em]
%
\eqnemph{${\plb\in\lt(\reals\bigcup\set{-\infty}\rt)^k}$, ${\pub\in\lt(\reals\bigcup\set{\infty}\rt)^k}$\\[0.5em]
%
${\qtemp\in\mat{n}{k}{\reals}:{k\leq n}},~~{\qtemp\transpose{\qtemp}:\text{invertible}}$.
}
}
\vspace{-0.5em}
%
{\small
\begin{exampleblock}{\center{$\ptope{\qtemp}{\plb}{\pub}$}}
\eqnemph{$\set{x\in\reals^n:~\plb\leq\qtemp x\leq\pub}$.}
\end{exampleblock}
}
%
\end{minipage}
%
\begin{block}{}
\center{\eqnemph{$\lt(\iztope{\pinv{\qtemp}}{\lb}{\ub}\rt)\bigcap\ptope{\qtemp}{\plb}{\pub}
=\iztope{\pinv{\qtemp}}{\join{\lb}{\plb}}{\meet{\ub}{\pub}}$}.}
\end{block}
%
\begin{tikzpicture}[scale = 1.5]
\node[text width = 3cm] at (-1,0.75) {{\small $\qtemp = \mymatrix{1 & 0\\ -1 & 4}$\\[0.5em]$\lb = \mymatrix{0\\ 0}$ $\ub = \mymatrix{2\\3}$}};
\node[text width = 4cm] at (4.5,0.75) {{\small $\plb = \mymatrix{1\\ -\infty}$ $\pub = \mymatrix{\infty\\3}$}};
\draw[fill=red!30] (0,0)--(0,1)--(2,1.5)--(2,0.5)--cycle;
\fill[cyan] (1,1)--(3,1.5)--(3,-1.5)--(1,-2)--cycle;
\draw[dashed, thick, fill = green!30] (1,1)--(2,1.25)--(2,0.5)--(1,0.25)--cycle;
\draw[->, thick] (2,1.25)--(2.8,1.45);
\draw[->, thick] (1,0.25)--(1,-0.1);
\end{tikzpicture}
%
\end{frame}



%==================================================================================================================================

\begin{frame}{Augmented Complex Zonotope}
%
\begin{minipage}{0.6\textwidth}
\begin{itemize}
\item \plemph{Minkowski sum} of \plemph{template complex zonotope} and \plemph{interval zonotope}.
\item Some combining coefficients have \plemph{absolute value bounds} and others have \plemph{interval bounds}.
\end{itemize}
\end{minipage}
%
\vline\hspace{1em}
%
\begin{minipage}{0.33\textwidth}
\begin{block}{\center{$\acztope{\ptemp}{\cen}{\sfact}{\stemp}{\lb}{\ub}$}}
\eqnemph{
$\minsum{\tcztope{\ptemp}{\cen}{\sfact}}{\iztope{\stemp}{\lb}{\ub}}$.
}
\end{block}
\end{minipage}
%
\begin{alertblock}{}
$\ptemp$: Primary template, $\cen$: primary offset, $\sfact$: scaling factors, $\stemp$: secondary template, $\lb$: lower interval bound, $\ub$: upper interval bound.
\end{alertblock}
%
\begin{tikzpicture}[block/.style={rectangle, fill=magenta!60}]
\draw[fill=cyan] (0,0) ellipse (1.5cm and 0.75cm);
\node at (2,0) {$\bigoplus$};
\draw[fill=orange] (2.5,-0.5) rectangle (4.5,0.5);
\fill[brown!30] (3,0)--(6,0)--(6,-1)--(3,-1)--cycle;
\draw[->] (3,0)--(3,-1);
\draw[->] (3,0)--(6,0);
\draw[dashed,thick,fill=green] (3,0)--(4.5,0)--(4.5,-0.5)--(3,-0.5);
\draw[->] (0,0)--(0,-1);
\node [text width = 4cm] at (0,-1.5) {Captures contraction\\along complex vectors};
\node at (7,0.3) {Over-approximates intersection};
\node at (7.8,0) {with sub-parallelotope};
\end{tikzpicture}
\end{frame}

%==================================================================================================================================

\begin{frame}{Intersection with Minkowski sum}
%
\begin{minipage}{0.48\textwidth}
Let us consider set\\ \eqnemph{$S:~\forall i\in\set{1,...,k}$} and
%
\eqnemph{
\begin{block}{}
$\lt(\identity{n}{n}-\diagonal{\bm{e}_i}\rt)\qtemp S \subseteq \qtemp S$.
\end{block}
}
%
\end{minipage}
%
\begin{minipage}{0.48\textwidth}
%
\begin{center}
$\forall P\in \qtemp S$.
\begin{tikzpicture}[scale=1]
\coordinate (samplept) at (1.15,0.83);
\draw[fill=cyan] (0,0) ellipse (2cm and 1cm);
\fill[color=yellow] (0,0) rectangle (samplept);
\draw[dashed, thick, ->] (0,0)--(samplept);
\node at (1.17,1) {P};
\end{tikzpicture}
\end{center}
%
\end{minipage}
%
\pause
%
\begin{block}{Result}
\begin{itemize}
\eqnemph{
\item $\lt(\lt(S\oplus \iztope{\pinv{\qtemp}}{\lb}{\ub}\rt)\bigcap\ptope{\qtemp}{\plb}{\pub}\rt)
\subseteq \lt(S \oplus\iztope{\pinv{\qtemp}}{\join{\lb}{\plb}}{\meet{\ub}{\pub}}\rt).$
}
\item \plemph{Over-approximation error} positively correlated to \plemph{size of $\qtemp S$}.
\end{itemize}
\end{block}
%
\vspace{-1.5em}
%
\begin{center}
\begin{tikzpicture}[block/.style={rectangle, fill=magenta!60}]
\draw[fill=cyan] (0,0) ellipse (1.5cm and 0.75cm);
\node at (2,0) {$\bigoplus$};
\draw[fill=orange] (2.5,-0.5) rectangle (4.5,0.5);
\fill[brown!30] (3,0)--(6,0)--(6,-1)--(3,-1)--cycle;
\node at (5.5,-0.6) {$T$};
\draw[->] (3,0)--(3,-1);
\draw[->] (3,0)--(6,0);
\draw[dashed,thick,fill=green] (3,0)--(4.5,0)--(4.5,-0.5)--(3,-0.5);
\draw[->,thick] plot [smooth] coordinates{(0.8,0.5) (1.5,1) (3,0.5)};
\node at (1.5,1.3) {$\Psi_1$};
\draw[->,thick] plot [smooth] coordinates{(0.8,-0.5) (1.5,-1) (3.5,-0.5)};
\node at (1.5,-1.3) {$\Psi_2$};
\node[block] at (8,0) {{\Large
$\lt(\Psi_1\bigcap T\rt)\subseteq\Psi_2$
}};
\end{tikzpicture}
\end{center}
%
\end{frame}

%==================================================================================================================================

\begin{frame}{Augmented Complex Zonotope $\bigcap$ Sub-parallelotope}
%
\begin{minipage}{0.48\textwidth}
Let us consider set\\ \eqnemph{$S:~\forall i\in\set{1,...,k}$} and
%
\eqnemph{
\begin{block}{}
$\lt(\identity{n}{n}-\diagonal{\bm{e}_i}\rt)\tcztope{\qtemp\ptemp}{\qtemp\cen}{\sfact}$\\ $\order  \tcztope{\qtemp\ptemp}{\qtemp\cen}{\sfact}$.
\end{block}
}
%
\end{minipage}
%
\begin{minipage}{0.48\textwidth}
%
\begin{center}
$\forall P\in \qtemp S$.
\begin{tikzpicture}[scale=1]
\coordinate (samplept) at (1.15,0.83);
\draw[fill=cyan] (0,0) ellipse (2cm and 1cm);
\fill[color=yellow] (0,0) rectangle (samplept);
\draw[dashed, thick, ->] (0,0)--(samplept);
\node at (1.17,1) {P};
\end{tikzpicture}
\end{center}
%
\end{minipage}
%
\begin{block}{Result}
\begin{itemize}
\eqnemph{
\item $\lt(\acztope{\ptemp}{\cen}{\sfact}{\pinv{\qtemp}}{\lb}{\ub}\bigcap\ptope{\qtemp}{\plb}{\pub}\rt)
\subseteq \acztope{\ptemp}{\cen}{\sfact}{\pinv{\qtemp}}{\join{\lb}{\plb}}{\meet{\ub}{\pub}}.$
}
\item \plemph{Over-approximation error} positively correlated to \plemph{size of $\qtemp S$}.
\end{itemize}
\end{block}
%
\vspace{-1.5em}
%
\begin{center}
\begin{tikzpicture}[block/.style={rectangle, fill=magenta!60}]
\draw[fill=cyan] (0,0) ellipse (1.5cm and 0.75cm);
\node at (2,0) {$\bigoplus$};
\draw[fill=orange] (2.5,-0.5) rectangle (4.5,0.5);
\fill[brown!30] (3,0)--(6,0)--(6,-1)--(3,-1)--cycle;
\node at (5.5,-0.6) {$T$};
\draw[->] (3,0)--(3,-1);
\draw[->] (3,0)--(6,0);
\draw[dashed,thick,fill=green] (3,0)--(4.5,0)--(4.5,-0.5)--(3,-0.5);
\draw[->,thick] plot [smooth] coordinates{(0.8,0.5) (1.5,1) (3,0.5)};
\node at (1.5,1.3) {$\Psi_1$};
\draw[->,thick] plot [smooth] coordinates{(0.8,-0.5) (1.5,-1) (3.5,-0.5)};
\node at (1.5,-1.3) {$\Psi_2$};
\node[block] at (8,0) {{\Large
$\lt(\Psi_1\bigcap T\rt)\subseteq\Psi_2$
}};
\end{tikzpicture}
\end{center}
%
\end{frame}

%==================================================================================================================================



\begin{frame}{Affine Substitution for Meet and Join}

{\small
\begin{exampleblock}{Min and Max-approximation functions}
\vspace{-1em}
\begin{align*}
&\lt(\minapprox{\ub}{\pub}\rt)_i=
\lt\{
\begin{array}{l}
\ub_i~\text{if}~\pub_i=\infty\\
\pub_i~\text{if}~\pub_i<\infty
\end{array}
\rt.,\hspace{1em}
\lt(\maxapprox{\lb}{\plb}\rt)_i=
\lt\{
\begin{array}{l}
\lb_i~\text{if}~\plb_i=-\infty\\
\plb_i~\text{if}~\plb_i>-\infty
\end{array}
\rt.\\
\end{align*}
%
\end{exampleblock}
}
%
\begin{block}{Result}
\center{If $\lb\leq\maxapprox{\lb}{\plb}\leq\minapprox{\ub}{\pub}\leq\ub$, then\\
\eqnemph{
$\join{\lb}{\plb}=\maxapprox{\lb}{\plb},~~\meet{\ub}{\pub}=\minapprox{\ub}{\pub}.$
}
}
%
\end{block}
%
\begin{alertblock}{}
{\small Therefore, \posemph{intersection} between augmented complex zonotope and sub-parallelotope over-approximated by \posemph{second order conic program} for \posemph{fixed templates}.}
\end{alertblock}
\end{frame}

%==================================================================================================================================

%==================================================================================================================================

%
\begin{frame}{Applications}
Verifying
\begin{enumerate}
\item \plemph{Linear invariance property} of \plemph{discrete time affine hybrid systems}.
\item \plemph{Stability} of \plemph{linear impulsive systems} with \plemph{sampling time uncertainty}.
\end{enumerate}
\end{frame}

%==================================================================================================================================

\begin{frame}{Checking Positive Invariance for Affine Hybrid System}
%
\begin{minipage}{0.45\textwidth}
\plemph{Continuous transition}:

%
\begin{tikzpicture}
\draw[fill=red] (0,0) circle (0.7);
\node at (0,0) {{\Large $q$}};
\node[text width = 4cm] at (0,1) {Stay: $x\in\ptope{\qtemp}{\lb_q}{\ub_q}$};
\node[text width = 5cm] at (0,-1) {{ \hspace{3em}$A_q x\oplus\acztope{\ptemp_q^{\operatorname*{inp}}}{\cen_q^{\operatorname*{inp}}}{\sfact_q^{\operatorname*{inp}}}{\stemp_q^{\operatorname*{inp}}}{\lb_q^{\operatorname*{inp}}}{\ub_q^{\operatorname*{inp}}}$}};
\end{tikzpicture}
%
%% \begin{align*}
%% & \exists l^\pr_q,u^\pr_q:\\
%% & \mathcal{G}\lt(\begin{array}{l}
%% \mymatrix{A\ptemp_q & \ptemp_q^{\operatorname*{inp}}},{A\cen_q+\cen_q^{\operatorname*{inp}}},{\mymatrix{\sfact\\\sfact_q^{\operatorname*{inp}}}}\\
%% {\mymatrix{\stemp_q & \stemp_q^{\operatorname*{inp}}}},{\mymatrix{\lb\\\lb_q^{\operatorname*{inp}}}},{\mymatrix{\ub\\\ub_q^{\operatorname*{inp}}}}
%% \end{array}
%% \rt)
%% \end{align*}
\end{minipage}
%
\hspace{0.5em}\vline\hspace{0.5em}
%
\begin{minipage}{0.45\textwidth}
\plemph{Discrete transition}:

\begin{tikzpicture}
\draw[fill=red] (-1,0) circle (0.5);
\draw[fill=red] (1,0) circle (0.5);
\draw[thick,->] (-0.5,0)--(0.5,0);
\node at (-1,0) {{\Large ${\sigma_1}$}};
\node at(1,0) {{\Large ${\sigma_2}$}};
\node[text width = 6cm] at (1,1) {Respective Staying conditions;\\ Guard: $x\in\ptope{\qtemp}{\lb_\sigma}{\ub_\sigma}$;};
\node[text width = 5cm] at (1,-1) {{ \hspace{3em}$A_\sigma x\oplus\acztope{\ptemp_\sigma^{\operatorname*{inp}}}{\cen_\sigma^{\operatorname*{inp}}}{\sfact_\sigma^{\operatorname*{inp}}}{\stemp_\sigma^{\operatorname*{inp}}}{\lb_\sigma^{\operatorname*{inp}}}{\ub_\sigma^{\operatorname*{inp}}}$}};
\end{tikzpicture}
%
\end{minipage}
%
\pause
%
\begin{tikzpicture}
\draw[fill=cyan,scale=1.5] plot[smooth cycle] coordinates{(0,0) (0.2,0.8) (0.8, 1.5) (2, 1) (1.3, 0.3)};
\pause
\fill[fill=brown!30,scale=2] (0.5,0.2) rectangle (2,1);
\draw[very thick, red, rotate around = {45:(2,2)},xshift=0.1cm, yshift=1cm,scale=1.2] plot[smooth cycle] coordinates{(0,0.1) (0.2,1) (0.8, 1.5) (1.7,0.9) (1.2, 0.1)};
\node[text width=4cm] at (2,-1) {Over-approximation of pre-transition intersection\\by augmented complex zonotope};
\pause
\draw[->,yshift=1cm,xshift=0.5cm,thick] (1,0)--(5,0);
\node at (3.6,1.3) {Affine transition};
\draw[fill = green,rotate around = {0:(2,2)},xshift=5.5cm, yshift=0.1cm,scale=1.1] plot[smooth cycle] coordinates{(0,0.1) (0.2,1.8) (0.8, 1.8) (1.7,0.9) (1.2, 0.1)};
\pause
\fill[fill=brown!30,scale=2,xshift=2.55cm,yshift=0.1] (0.5,0.2) rectangle (2,1);
\draw[very thick, color=blue, xshift=5cm, scale=2.1] plot [smooth cycle] coordinates{(0.5,0.2) (0.5,1)  (0.75,1) (1,0.5) (1,0.2)};
\node[text width=4cm] at (7,-1) {Over-approximation of post-transition intersection\\by augmented complex zonotope};
\pause
\draw[fill=blue, xshift=5cm, scale=2.1] plot [smooth cycle] coordinates{(0.5,0.2) (0.5,1)  (0.75,1) (1,0.5) (1,0.2)};
\draw[very thick, black, scale=1.5,xshift=3.45cm,yshift=0cm,scale=1.1] plot[smooth cycle] coordinates{(0,0) (0.2,0.8) (0.8, 1.5) (2, 1) (1.3, 0.3)};
\node at (8.5,1.2) {Check Inclusion};
\end{tikzpicture}
%
\end{frame}

%==================================================================================================================================

\begin{frame}{Verifying Linear Invariance by Convex Optimization}
%
\begin{minipage}{0.48\textwidth}
\begin{tikzpicture}[scale=2.5]
\draw[fill=cyan] plot[smooth cycle] coordinates {(0,0) (0.5,1)
(1,1.2) (1.5,0.9) (1.2,0) };
\draw[fill=red!30] plot[smooth cycle] coordinates {(0.2,0.2) (0.5,0.8)
(1,1) (1.5,0.8) (1.2,0.2) };
\draw[->,thick] (0,0)--(0.2,0.2);
\draw[->,thick] (0.5,1)--(0.5,0.8);
\draw[->,thick] (1,1.2)--(1,1);
\draw[->,thick] (1.5,0.9) -- (1.48,0.79);
\draw[->,thick] (1.2,0)--(1.2,0.2);
\draw[fill=white] (0.5,0) rectangle (1,0.5);
\node[text width = 0.25cm] at (0.75, 0.25) {\small Init.\\ Set };
\draw[thick] (-0.025 ,-0.1) rectangle (1.5,1.2);
\end{tikzpicture}
\end{minipage}
%
\begin{minipage}{0.48\textwidth}
\fbox{\posemph{Single step of convex optimization}}
\end{minipage}
\pause
%
\begin{enumerate}
\item Fix \plemph{primary} and {secondary templates} of complex zonotope.
\begin{itemize}
\item Secondary template is \plemph{pseudo-inverse} of primary template.
\item Choice of \plemph{primary template} discussed \plemph{later}.
\end{itemize}
\pause
\item \plemph{Aforementioned steps} for checking positive invariance can be written as \plemph{convex constraints} on
\plemph{primary offset, scaling factors, lower and upper interval bounds}.
\begin{itemize}
\item As discussed in \plemph{operations on complex zonotopes}.
\end{itemize}
\pause
\item Write \plemph{bound on support function} which is an {affine constraint}.
\pause
\item Write \plemph{convex constraints} for \plemph{inclusion} of \plemph{initial set}.
\end{enumerate}
%
\end{frame}

%==================================================================================================================================

\begin{frame}{Choice of Primary Template}


\end{frame}

%==================================================================================================================================

\begin{frame}{Nearly Periodic Linear Impulsive System}
                     
\end{frame}

%==================================================================================================================================


\bibliographystyle{plain}
\bibliography{ref}



\end{document}

