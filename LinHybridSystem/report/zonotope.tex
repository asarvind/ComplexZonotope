
Before introducing augmented complex zonotopes, we briefly review the
related set representations that are used in this paper. First,
polytopes can be defined in terms of halfspace representation.
%
%\begin{definition}
Let $T\in\mat{n}{k}{\mb{R}}$ and $d\in\mb{R}^k$.  Then a (possibly
unbounded) \emph{polytope}, denoted by $\polytope{T}{d}$, is defined as
$\polytope{T}{d} = \lt\{x\in\comprealset^k: Tx\leq d\rt\}$.
%\end{definition}
%
Usual zonotopes form a subclass of polytopes, which are geometrically
Minkowski sums of line segments. They are represented as a linear
combination of real vectors, called \emph{generators}, whose combining
coefficients are bounded in real-valued intervals.
%\begin{definition}[Real zonotope]
Let $W\in\mat{n}{k}{\mb{R}}$ and $l,u\in\mb{R}^m: l\leq u$.  Then 
 a \emph{real zonotope} is
%\begin{equation*}
$\zon{W}{l}{u} = \lt\{W\zeta: \zeta\in\mb{R}^k,~\zeta_i\in[l_i,u_i]~\forall i\in \tup{k}\rt\}.$
%\end{equation*}
%\end{definition}
%
For simple examples of zonotopes like boxes and octagons, efficient
interconversion between the zonotopic representation and halfspace
polytopic representation is possible.  However, in general, zonotopes
do not admit efficient halfspace representations as polytopes. The
reason is that a zonotope with $m$ generators in an $n$-dimensional
space has ${m}\choose{n}$ faces (bounding hyperplanes), if all
combinations of $n$ generators are linearly independent. That is, the
halfspace representation of a zonotope can be exponentially large,
compared to the above generator representation.

Zonotopes are closed under linear transformations and Minkowski sums, which can be computed efficiently.  Hence, zonotopes are
considered efficient for reachability analysis of continuous linear systems.  Nevertheless,
a major drawback of zonotopes is that their intersection with sets defined by linear
constraints need not be zonotopes.  Also, there is no unique smallest
zonotope that overapproximates such intersections.  However, we observe that when the linear constraints
constitute a sub-parallelotope with a template aligned with that of
the zonotope, their intersection can be exactly computed.  This is
also the reason we considered the case of staying conditions and guards specified as sub-parallelotopes 
in this work. As a simple example, the intersection of
$\zon{\lt[\begin{array}{l l}1 & 0 \\ 0 &
      1\end{array}\rt]}{\lt[\begin{array}{c}-1\\ -1\end{array}\rt]}{\lt[\begin{array}{c}2\\ 2\end{array}\rt]}$
with $x_1\leq 1~\wedge~x_2\geq 0.5$ gives $\zon{\lt[\begin{array}{l
        l}1 & 0 \\ 0 &
      1\end{array}\rt]}{\lt[\begin{array}{c}-1\\ 0.5\end{array}\rt]}{\lt[\begin{array}{c}1\\ 2\end{array}\rt]}$.
The general case is described in the following lemma, a proof of which is included in Appendix.
%
\begin{lemma}~\label{lem:motivation}
Let $K\in\mat{k}{n}{R}$ such that $k\leq n$ and $\lt(KK^T\rt)$ is
non-singular.  Then
\[
\zon{\pinv{K}}{l}{u} \bigcap \sptope{K}{\wh{l}}{\wh{u}}
= \zon{K}{l\bigvee \wh{l}}{u\bigwedge \wh{u}}
\]
\end{lemma}
%
To incorporate the possibly complex (having real and imaginary parts)
eigenstructure of linear maps while computing invariants, the complex
zonotope set representation and its generalization to the template
complex zontope were introduced in~\cite{adimoolamACC2016,tcz2017}.
A template complex zonotope has complex valued vectors as generators,
whose combining coefficients are complex and bounded in their absolute
values.
%
\begin{definition}[Template complex zonotope]
Let $V\in\mat{n}{m}{\mb{C}}$ (template) and $s\in\mb{R}^m_{\geq 0}$ (scaling factors) and
$c\in\realset^n$ (center).  Then the following is a template complex zonotope:
%\begin{equation*}
$\cz{V}{c}{s} =
\lt\{V\epsilon:\epsilon\in\mb{C}^m,~\lt|\epsilon_i\rt|\leq s_i~\forall
i\in\tup{m}\rt\}.$
%\end{equation*}
\end{definition}
%
Unlike real zonotopes, a template complex zonotope can have a
non-polyhedral real projection.  Therefore, in general, checking the
exact inclusion between two template complex zonotopes amounts to
solving a non-convex optimization problem, which could be
computationally intractable.  Instead, a convex condition was proposed
in~\cite{tcz2017}, which is sufficient to guarantee the inclusion
between template complex zonotopes.  Here, we present this condition
as a relation between template complex zonotopes.  
%
\begin{definition}
We define a relation ``$\order$'' between template complex zonotopes
as\\ $\cz{V^\pr_{n\times m^\pr}}{c^\pr}{s^\pr}\order \cz{V_{n\times
    m}}{c}{s}$ if all of the below statements are collectively true.
\begin{align}~\label{eqn:tcz-inc}
\begin{split}
& \exists X\in\mat{m}{m^\pr}{\mb{C}}~\text{and}~y\in\mb{C}^{m}~\text{s.t.}\\
& \transfer{V}{V^\pr}{s^\pr}{X},~~~\centertransfer{V}{c}{c^\pr}{y}\\
& \scalebound{X}{y}{s}{m}{m^\pr}\leq 0\\
\end{split}
\end{align}
\end{definition}
%
\begin{lemma}[Inclusion: template complex
  zonotopes]~\label{lem:zon-zon} The
inclusion $\cz{V^\pr}{c^\pr}{s^\pr}\subseteq \cz{V}{c}{s}$ holds if
the relation $\cz{{V^\pr}}{c^\pr}{s^\pr}\order \cz{V}{c}{s}$ is true.
\end{lemma}
\emph{Proof idea.}
We relate the combining
coefficients of the two template complex zonotopes by a linear
transformation, with appropriate bounds on the transformation matrix
such that the inclusion holds.

For fixed $V$ and $V^\pr$, we observe that~(\ref{eqn:tcz-inc}) is
equivalent to a set of convex constraints called second order
conic constraints.  
%
%\begin{definition}[SOCC]
Recall that A constraint of the form $\|Ax\|_{2}+Fx+b\leq 0$ on an $n$-dimensional
variable $x$, given $A,F\in\mat{n}{k}{\realset}$ and $b\in\mb{R}^k$, is
a second order conic constraint (SOCC).
%\end{definition}
%
We also note that linear inequalities and equalities can be expressed
in the form of SOCC described above. There are many convex optimization tools that can efficiently solve
SOCC up to a high numerical precision. Our aforementioned observation
about~(\ref{eqn:tcz-inc}) is formalized below.
%
\begin{proposition}~\label{lem:zon-socc}
For fixed $V$,$V^\pr$, the relation
$\cz{V^\pr}{c^\pr}{s^\pr}\order \cz{V}{c}{s}$ is equivalent to a set
of second order conic constraints on the variables
$c,c^\pr,s,s^\pr,\mathbf{l,l^\pr}$ and some additional variables. TOCHECK
\end{proposition}
%

