An augmented complex zonotope is the Minkowski sum of a template
complex zonotope and a real zonotope. In terms of expressivity, an
augmented complex zonotope is slightly more general than template
complex zonotopes.  But geometrically, the sets that can be described
as real projections of augmented complex zonotopes can also be
described as real projections of template complex zonotopes.  However,
with augmented complex zonotopes, the intersection with
subparallelotopic constraints can be succinctly specified, as we will
see latter. Consequently, this representation is more convenient to
derive conditions for computing invariants for the affine hybrid
system.
%
\begin{definition}[Augmented complex zonotope]
Let $V\in\mat{n}{m}{C}$ called primary template, $W\in\mat{n}{k}{R}$
called secondary template, $c\in\mb{R}^n$ called primary offset,
$s\in\mb{R}^m$ called scaling factors, $u,l\in\mb{R}^k$ called lower
and upper interval bounds, respectively, such that $l\leq u$.  The
following is an augmented complex
zonotope.
\begin{equation*}
=\gcz{V}{c}{s}{W}{l}{u} = \cz{V}{c}{s}\oplus\zon{W}{l}{u}.
\end{equation*}
\end{definition}
%
\subsection{Intersection with sub-parallelotope}
In invariant computation, we have to overapproximate the intersection
between the augmented complex zonotope and sub-parallelotopic
constraints.  We first discuss the intersection operation before
discussing other operations on augmented complex zonotope.  For
deriving a formula for the intersection, we require some results about
intersection among convex sets.  

Let us define the support of a vector $v\in\realset^n$ in a set
$S\in\realset^n$ relative to a point $w\in\realset^n$ as
$\support{w}{v}{S}=\max_{x\in S}v^T\lt(x-w\rt)$.   Then the following
lemma states a relationship between support of vectors and inclusion
between sets.
%
\begin{lemma}~\label{supp-inclusion}
Let $S_1,S_2\subseteq \realset^n$ be two closed convex sets such that
$S_1\bigcap S_2\neq \emptyset$.  Let $w\in S_1\bigcap S_2$.
Then $S_1\subseteq S_2$ iff $\forall
v\in\realset^n:~\support{w}{v}{S_1}\leq \support{w}{v}{S_2}$.
\end{lemma}
Let us say that two convex and closed sets $S_1$ and $S_2$ have
non-empty intersection and $w$ is a common point, i.e., inside the
sets.  According to the above lemma, the fact that $S_1$ is contained
inside $S_2$, is equivalent to saying that the maximum possible
displacement in $S_1$ from $w$ along the direction of any
vector $v$ is less than the maximum possible displacement in $S_2$
from $w$ along the direction of the vector $v$.

We defined an augmented complex zonotope as a Minkowski sum of a
complex zonotope and a real zonotope, i.e.,
$\cz{V}{c}{s}\oplus\zon{W}{l}{u}$.  In Lemma~\ref{lem:motivation}, we
have seen that the intersection of a sub-parallelotope
$\sptope{K}{\wh{l}}{\wh{u}}$ with a zonotope $\zon{W}{l}{u}$ can be
computed when $W=\pinv{K}$.  This being the motivation, we want to
find a condition under which we can overapproximate the intersection
of an augmented complex zonotope with a sub-parallelotope
$\lt(\cz{V}{c}{s}\oplus\zon{W}{l}{u}\rt)\bigcap\sptope{K}{\wh{l}}{\wh{u}}$
by the intersection
$\cz{V}{c}{s}\oplus\lt(\zon{W}{l}{u}\bigcap\sptope{K}{\wh{l}}{\wh{u}}\rt)$.
More generally, we find the required condition in the case of any
three closed convex sets sets $S_1,S_2,S_3$ and apply the result to
augmented complex zonotope.  That is, find a condition under which
$\lt(S_1\oplus S_2\rt)\bigcap S_3$ can be overapproximated by
$S_1\oplus\lt(S_2\bigcap S_3\rt)$.  We state and derive the required
condition as follows.
%
\begin{lemma}~\label{gen-int}
Let $S_1,S_2,S_3\in\complexset^n$ be closed convex sets such that
$S_2\cap S_3\neq \emptyset$ and $0\in S_1$.  Then $\lt(S_1\oplus S_2\rt)\bigcap
S_3\subseteq S_1\oplus\lt(S_2\cap S_3\rt)$.
\end{lemma}
\begin{proof}
 Let $w\in S_2\bigcap S_3$.  Then, since $0\in S_1$, so $w=w+0\in
 S_1\oplus S_2$.  Therefore, $w\in \lt(S_1\oplus S_2\rt)\bigcap S_3$.
 So, based on Lemma~\ref{supp-inclusion}, it sufficient to prove that
 for any $v\in\realset^n$, $\support{w}{v}{\lt(S_1\oplus
   S_2\rt)\bigcap S_3}\leq \support{w}{v}{S_1\oplus\lt(S_2\cap
   S_3\rt)}$.

Let us define $a = \support{0}{v}{S_1}$, $b=\support{w}{v}{S_2}$ and
$c = \support{w}{v}{S_3}$.  It is easy to see that if a point belongs
to a set, then relative to that point, the support in any direction is
always greater than zero.  Since $w\in S_2\bigcap S_3$, so $b\geq 0$
and $c\geq 0$.  Since, $0\in S_1$, so also $a\geq 0$.  Also, the
support of the intersection of two closed sets relative to $w$ is the
minimum of the support of the two sets relative to $w$.  So,
$\support{w}{v}{\lt(S_1\oplus S_2\rt)\bigcap S_3}$ $=
\min\lt(\support{w}{v}{S_1\oplus S_2},\support{w}{v}{S_3}\rt)$.  As
$w$ can be written as $w+0$, so the above equals
$\min\lt(\support{0}{v}{S_1}+\support{w}{v}{S_2},\support{w}{v}{S_3}\rt)
= \min(a+b,c)$.  On the other hand, by a similar computation, we can
show $\support{w}{v}{S_1\oplus\lt(S_2\cap S_3\rt)} = a+min(b,c)$.  So,
we need to show $\min(a+b,c)\leq a+min(b,c)$.  We prove this in two
cases. Case 1: Let $b\geq c$.  In this case, since $a\geq 0$ and
$b\geq c$, so $\min(a+b,c) = c \leq a+c = a+\min(b,c)$.  Case 2: Let
$b\leq c$.  In this case, $\min(a+b,c)\leq a+b = a+\min(b,c)$, since
$b=min(b,c)$.
\end{proof}

Now, we define the following functions which are used latter to
express the overapproximation of the intersection between an augmented
complex zonotope and a sub-parallelotope.
%
Let us define a binary function
$\minaffinefunc:\realset^k\times\comprealset^k$,
called \emph{min-approximation} function, as follows.  For
$u\in\realset^k$ and $\wh{u}\in\comprealset^k$,
$\lt(\minaffine{u}{\wh{u}}\rt)_i = \left\{
\begin{array}{l}
\wh{u}_i~~\text{if}~\wh{u}_i<\infty\\
u_i~~\text{if}~\wh{u}_i=\infty
\end{array}
\right..$
Similarly, let us define another binary function       
$\maxaffinefunc:\realset^k\times\comprealset^k$,
called \emph{max-approximation} function, as follows.  For
$l\in\realset^k$ and $\wh{l}\in\comprealset^k$,
$\lt(\maxaffine{l}{\wh{l}}\rt)_i = \left\{
\begin{array}{l}
\wh{l}_i~~\text{if}~\wh{l}_i>\infty\\
l_i~~\text{if}~\wh{l}_i=-\infty
\end{array}
\right..$
%
Then, the following lemma is used to overapproximate the intersection
of an augmented complex zonotope with a sub-parallelotope, which is
expressed in terms of min and max approximation function.
\begin{theorem}~\label{lem:acz-int}
Consider a sub-parallelotope $\sptope{\ptemplate}{\wh{l}}{\wh{u}}$ an
augmented complex zonotope $\gcz{V}{c}{s}{\pinv{\ptemplate}}{l}{u}$
such that $VV^T$ is non-singular, $\lt|\pinv{V}c\rt|\leq s$, $l\leq
\maxaffine{l}{\wh{l}}$ and $u\geq \minaffine{l}{\wh{l}}$.  Then
$\gcz{V}{c}{s}{\pinv{\ptemplate}}{l}{u}\bigcap\sptope{\ptemplate}{\wh{l}}{\wh{u}}\subseteq
\gcz{V}{c}{s}{\pinv{\ptemplate}}{l\bigvee\wh{l}}{u\bigwedge\wh{u}}$.
\end{theorem}
\begin{proof}
  Since, $\maxaffine{l}{\wh{l}}\leq l$ as given, while we know
  $\maxaffine{l}{\wh{l}}\leq l\bigvee\wh{{l}}$, so
  $l\bigvee\wh{l}=\maxaffine{l}{\wh{l}}$. Similary, we can show
  $u\bigwedge \wh{u}=\minaffine{u}{\wh{u}}$.  We recall that
  $\gcz{V}{c}{s}{\pinv{\ptemplate}}{l}{u}=\cz{V}{c}{s}\oplus\zon{\pinv{\ptemplate}}{l}{u}$.
  Furthermore, by Lemma~\ref{lem:motivation}, we get
  $\zon{\pinv{\ptemplate}}{\wh{l}}{\wh{u}}\bigcap\sptope{\ptemplate}{\wh{l}}{\wh{u}}$
  is equal to
  $\zon{\pinv{\ptemplate}}{l\bigvee\wh{l}}{u\bigwedge{\wh{l}}}$, which
  equals
  $\zon{\pinv{\ptemplate}}{\maxaffine{l}{\wh{l}}}{\minaffine{u}{\wh{u}}}$
  by what we derived above.  So, provided the conditions in Lemma 4
  are satisfied, i.e., $0\in S_1$ and $S_2\bigcap S_3\neq 0$, the
  proof is accomplished by substituting $S_1=\cz{V}{c}{s}$,
  $S_2=\zon{\pinv{\ptemplate}}{l}{u}$ and
  $S_3=\sptope{\ptemplate}{\wh{l}}{\wh{u}}$ in the Lemma.  The prove
  that the conditions are satisfied as follows.  We write $0
  = c-V\pinv{V}c$, and since $\lt|\pinv{V}c\rt|\leq s$ as given, so
  $0\in \cz{V}{c}{s}=S_1$.  Next, since consider
  $w=\pinv{\ptemplate}\maxaffine{l}{\wh{l}}$.  Since $l\leq
  \maxaffine{l}{\wh{l}}\leq \minaffine{u}{\wh{u}}\leq u$, so
  $w\in\zon{\pinv{\ptemplate}}{l}{u}= S_2$.  Also, $\ptemplate
  w=\ptemplate\pinv{\ptemplate}\maxaffine{l}{\wh{l}} =
  \maxaffine{l}{\wh{l}}$ and $\wh{l}\leq \maxaffine{l}{\wh{l}}\leq
  \minaffine{u}{\wh{u}}\leq \wh{u}$, so $w\in
  \sptope{\ptemplate}{\wh{l}}{\wh{u}}=S_3$.  So, $S_2\bigcap S_3\neq
  0$, thus the required condition for Lemma~\ref{gen-int} to be
  applied is satisfied.
\end{proof}
%
%% To illustrate, the intersection of $\gcz{\lt[\begin{array}{cc}1+2i &
%% 2+i\\1-2i & 2-i\\0 &
%% 0\end{array}\rt]}{\lt[\begin{array}{c}1\\1\\0\end{array}\rt]}{\lt[\begin{array}{c}1\\1\\1\end{array}\rt]}
%% {\lt[\begin{array}{c}0\\0\\1\end{array}\rt]}{-2}{2}$. with a
%% constraint on the third coordinate $-1\leq x_3\leq 1$ is exactly\\
%% $\gcz{\lt[\begin{array}{cc}1+2i & 2+i\\1-2i & 2-i\\0 &
%% 0\end{array}\rt]}{\lt[\begin{array}{c}1\\1\\0\end{array}\rt]}{\lt[\begin{array}{c}1\\1\\1\end{array}\rt]}
%% {\lt[\begin{array}{c}0\\0\\1\end{array}\rt]}{-1}{1}$.  We observe that
%% the center $\lt(\begin{array}{c}1\\1\\0\end{array}\rt)$ is
%% perpendicular to the third axis, i.e., the vector
%% $\lt[\begin{array}{ccc}0 & 0 & 1\end{array}\rt]$, which is a required
%% condition in the above lemma.  Furthermore, since the primary template
%% is orthogonal to the subparallelotopic template in this example, i.e.
%% $\lt[\begin{array}{ccc}0 & 0 &
%% 1\end{array}\rt]\lt[\begin{array}{cc}1+2i & 2+i\\1-2i & 2-i\\0 &
%% 0\end{array}\rt]=0$, the resultant intersection is exactly an
%% augmented complex zonotope.  On the other hand, if the primary
%% template is not orthogonal with the secondary template, like in the
%% case of $\gcz{\lt[\begin{array}{cc}1+2i & 2+i\\1-2i & 2-i\\1 &
%% 1\end{array}\rt]}{\lt[\begin{array}{c}1\\1\\0\end{array}\rt]}{\lt[\begin{array}{c}1\\1\\1\end{array}\rt]}
%% {\lt[\begin{array}{c}0\\0\\1\end{array}\rt]}{-2}{2}$, then the
%% intersection with $-1\leq x_3\leq 1$ is overapproximated by
%% $\gcz{\lt[\begin{array}{cc}1+2i & 2+i\\1-2i & 2-i\\1 &
%% 1\end{array}\rt]}{\lt[\begin{array}{c}1\\1\\0\end{array}\rt]}{\lt[\begin{array}{c}1\\1\\1\end{array}\rt]}
%% {\lt[\begin{array}{c}0\\0\\1\end{array}\rt]}{-1}{1}$, but this is not
%% the exact intersected set.


Similar to usual zonotopes, augmented
complex zonotopes are closed under Minkowski sums and linear
transformations, and their computations are also similar. The computation of some important operations are summarized as follows.

\begin{enumerate}
\item $A\gcz{V}{c}{s}{W}{l}{u} = \gcz{AV}{Ac}{s}{AW}{l}{u}$.
\item $\gcz{V}{c}{s}{W}{l}{u}\oplus
  \gcz{V^\pr}{c^\pr}{s^\pr}{W^\pr}{l^\pr}{u^\pr}$\\
$= \gcz{\lt[V~~V^\pr\rt]}{c+c^\pr}{\ColumnJoin{s}{s^\pr}}{\lt[W~~W^\pr\rt]}{\ColumnJoin{l}{l^\pr}}{\ColumnJoin{u}{u^\pr}}$

%
\item The limits of the projection of an augmented complex zonotope along
any direction can be computed as follows. For $v\in\realset^n$,
\begin{equation}\label{lem:polylimits-acz}
\max_{x\in\gcz{V}{c}{s}{W}{l}{u}}v^Tx = v^T\lt(c+W\frac{l+u}{2}\rt)+\lt|v^T[V~~W]\rt|\lt(\ColumnJoin{s}{\frac{u-l}{2}}\rt)
\end{equation}
\end{enumerate}
%
%\begin{lemma}[Linear transformation and Minkowski sum]
%\begin{enumerate}
%\item $A\gcz{V}{c}{s}{W}{l}{u} = \gcz{AV}{Ac}{s}{AW}{l}{u}$.
%\item $\gcz{V}{c}{s}{W}{l}{u}\oplus
%  \gcz{V^\pr}{c^\pr}{s^\pr}{W^\pr}{l^\pr}{u^\pr}$\\
%$= \gcz{\lt[V~~V^\pr\rt]}{c+c^\pr}{\ColumnJoin{s}{s^\pr}}{\lt[W~~W^\pr\rt]}{\ColumnJoin{l}{l^\pr}}{\ColumnJoin{u}{u^\pr}}$
%\end{enumerate}
%\end{lemma}
%%
%The limits of the projection of an augmented complex zonotope along
%any direction are stated in the following lemma.
%%
%\begin{lemma}~\label{lem:polylimits-acz}
%Let $V\in\mat{n}{m}{\mb{C}}$ and $v\in\realset^n$.  Then,
%\[
%\max_{x\in\gcz{V}{c}{s}{W}{l}{u}}v^Tx = v^T\lt(c+W\frac{l+u}{2}\rt)+\lt|v^T[V~~W]\rt|\lt(\ColumnJoin{s}{\frac{u-l}{2}}\rt)
%\]
%\end{lemma}
%%%%%%%%%%%


The real projection of an augmented complex zonotope can be
equivalently transformed as the real projection of a template complex
zonotope, as follows.
%
\begin{lemma}~\label{lem:conversion}
$\real\lt(\gcz{V}{c}{s}{W}{l}{u}\rt) = \real\lt(\cz{\lt[V~W\rt]}{c+W\lt(\frac{u+l}{2}\rt)}{\ColumnJoin{s}{\frac{u-l}{2}}}\rt)$.
\end{lemma}
%
Because of the above relationship, checking the inclusion between the
real projections of two augmented complex zonotopes amounts to
checking the inclusion between real projections of two template
complex zonotopes.  Recall the relation between template complex
zonotopes that was a sufficient condition for inclusion.  We extend
the relation to augmented complex zonotopes as follows.
%
\begin{definition}~\label{defn:gcz-order}
We say that $\gcz{V^\pr}{c^\pr}{s^\pr}{W^\pr}{l^\pr}{u^\pr}\order
\gcz{V}{c}{s}{W}{l}{u}$ if\\ $\cz{\lt[V^\pr~W^\pr\rt]}{c^\pr+W^\pr\lt(\frac{u^\pr+l^\pr}{2}\rt)}{\ColumnJoin{s^\pr}{\frac{u-l}{2}}}
\order
\cz{\lt[V~W\rt]}{c+W\lt(\frac{u+l}{2}\rt)}{\ColumnJoin{s}{\frac{u-l}{2}}}.$
\end{definition}
%
\begin{lemma}[Inclusion: augmented complex
    zonotopes]~\label{lem:gcz-gcz} The real inclusion\\
$\real\lt(\gcz{V^\pr}{c^\pr}{s^\pr}{W^\pr}{l^\pr}{u^\pr}\rt)\subseteq \real\lt(\gcz{V}{c}{s}{W_{n\times
k}}{l}{u}\rt)$ holds if the relation\\
$\gcz{V^\pr}{c^\pr}{s^\pr}{W^\pr}{l^\pr}{u^\pr}\order \gcz{V}{c}{s}{W_{n\times
k}}{l}{u}$ is true.
\end{lemma}

The intersection of an augmented complex zonotope with a
subparallelotope involves the meet and join operations, as stated in
Lemma~\ref{lem:acz-int}.  These operations are piecewise affine
functions of their arguments, but not affine.  Hence, their
composition with a convex function may be non-convex.  But since we
are interested in deriving convex conditions for finding an invariant,
in this regard, we define the following upper and lower bound
functions for the join and meet operations, respectively.







