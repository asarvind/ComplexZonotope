In the previous chapter, we described a set representation called
simple zonotope, which is a type of polytope represented as a linear
combination of real valued vectors with bounded combining
coefficients.  The advantage of simple zonotopes in set based
computations is that they are closed under matrix multiplication and
Minkowski sum operations and these can be computed efficiently.
However, for computing a positive invariant of a linear system, there
is no known procedure to choose a suitable set of generators for a
simple zonotope so as to compute an invariant.  In this chapter, we
extend simple zonotope a new set representation called \emph{complex
zonotope} by which we can easily specify invariants of a linear system
using the eigenstructure of the system.  Complex zonotopes have
complex valued generators complex combining coefficients bounded in
their absolute values, as opposed to the real valued generators and
real combining coefficients of simple zonotopes.  The real projections
of complex zonotopes can describe some non-polytopic sets in addition
to the polytopic zonotopes, which are Minkowski sums of some
ellipsoids along with line segments.  Furthermore, complex zonotopes
are also closed under matrix multiplications and Minkowski sums and
these can be computed efficiently.

Apart from discussing operations on complex zonotopes like linear
transformations and Minkowski sums, in this chapter we derive a convex
program for checking inclusion between two complex zonotopes.  The
inclusion relation is a key ingredient for efficient invariant
computation, as we shall see in the latter chapters.  The organization
of this chapter is as follows.  PUT ORGANIZATION.

\section{Basic representation of a complex zonotope}
The basic representation of a complex zonotope is a generalization of
the representation of a simple zonotope given in Definition~\ref{todo}
to a space of complex valued vectors.  A complex zonotope is
represented as a linear combination of complex valued vectors, called
generators, such that the combining coefficients are bounded in their
absolute values by unity.  However, this representation can be
extended to more general forms for efficient computation, as we shall
discuss later.
%
\begin{definition}[Complex zonotope]
Let $\ptemp\in\mat{m}{n}{\compnums}$ be a complex valued matrix
whose columns are called generators and $\cen\in\compnums^n$ be a
complex valued vector called the center.  Then the following is a
complex zonotope.
%
\begin{equation}
\cztope{\ptemp}{\cen} = \set{\ptemp\zeta+\cen:~\zeta\in\compnums^m,~\infnorm{\zeta}\leq 1}.
\end{equation}
%
\end{definition}
%
Like a simple zonotope, a complex zonotope is also symmetric around
the center.  To see this, consider a point in a complex zonotope
centered at the origin, written as $y=\ptemp\zeta$ where $\ptemp$
defines the generator set and $\zeta$ is the vector of combining
coefficients.  Since, $\infnorm{-\zeta}=\infnorm{\zeta}\leq 1$, so
even $-y=\ptemp(-\zeta)$ belongs to the complex zonotope.  However, unlike
simple zonotopes, the real projection of a complex zonotope can
describe some non-polytopic sets in addition to polytopic zonotopes,
since geometrically speaking the real projection of a complex zonotope
can be a Minkowski sum of line segments as well as some ellipsoids.
An example of such a non-polyhedral complex zonotope projection in
real space is illustrated with Figure~\ref{fig:cz}, where the
generators are $\ptemp=\lt(\begin{array}{lll}(1+2i) & 1 & (2+i)\\(1-2i) & 1
& (2-i)\end{array}\rt)$ and the center is the origin.

A motivation for extending simple zonotopes to complex zonotopes is
that a complex zonotope with its generators as the complex
eigenvectors of a discrete time linear system will be a positively
invariant if the complex eigenvalues corresponding to the generators
are bounded within unity in their absolute values.  This property is
explained mathematically in the following proposition.
%
\begin{proposition}[Eigenstructure based invariance]
Consider a complex zonotope centered at the origin
$\cztope{\ptemp}{0}$, where the column vectors of
$\ptemp\in\mat{m}{n}{\compnums}$ are the complex eigenvectors of a
matrix $A\in\mat{n}{n}{\reals}$ and $\mu\in\compnums^m$ is a vector of complex
eigenvalues corresponding to the column vectors of $\ptemp$, i.e., $A\ptemp
= \ptemp\diagonal{\mu}$.
Then \[A\lt(\cztope{\ptemp}{0}\rt)
= \cztope{\ptemp\diagonal{\mu}}{0}.\] Furthermore, if $\infnorm{\mu}\leq
1$, then $A\lt(\rztope{\ptemp}{0}\rt)\subseteq \rztope{\ptemp}{0}$.
\end{proposition}
% 
\begin{proof}
We have $A\lt(\cztope{\ptemp}{0}\rt) =
A\set{\ptemp\zeta:~\zeta\in\compnums^m,\infnorm{\zeta}\leq 1}$\\
$=\set{A\ptemp\zeta:~\zeta\in\compnums^m,\infnorm{\zeta}\leq 1}
= \cztope{A\ptemp}{0}$.  Next $\cztope{A\ptemp}{0}
= \cztope{\ptemp\diagonal{\mu}}{0}$, which proves the first part of the
Proposition.  For the second part, we are given that
$\infnorm{\mu}\leq 1$.  Consider a point $y\in \cztope{\ptemp\diagonal{\mu}}{0}$,
described by the generators as
$y = \ptemp\diagonal{\mu}\delta:\infnorm{\delta}\leq 1$.
Let $\zeta = \diagonal{\mu}\delta$. Then
$\infnorm{\zeta} \leq \infnorm{\mu}\infnorm{\delta} \leq 1$.  So, 
$y=\ptemp\zeta$ where $\infnorm{\zeta}\leq 1$, and this implies $y\in \cztope{\ptemp}{0}$.
Therefore, $A\lt(\cztope{\ptemp}{0}\rt)=\cztope{A\ptemp}{0}\subseteq \cztope{\ptemp}{0}$.
\end{proof}
%
In reachability analysis based verification algorithms, the quality of
over-approximation of the reachable set computed by the algorithm, i.e,
the difference between the actual reachable set and the
over-approximation, affects the accuracy of verification.  So, for any
set representation used in reachability analysis, it is desirable that
there is an efficient way of refining a set to obtain smaller sets
that over-approximate the reachable set.  However, in the case of the
basic representation of a complex zonotope as given in the above
definition, adding a generator to the representation increases the
size of the complex zonotope.  Moreover, adding a generator can
violate positive invariance, as shown in Figure~\ref{todo}.  Instead,
to refine a complex zonotope, we may try to adjust the magnitude of
contribution of each generator to the size of the set in a way that
does not increase the size of the set and also preserves positive
invariance.  Therefore, in addition to the generators in the
representation of a complex zonotope, we can consider the magnitude of
contribution of each generator as a part of the representation.  This
would be a more general representation of a complex zonotope, which we
shall call as a template complex zonotope, and is defined as follows.

A template complex zonotope is a linear combination of complex valued
vectors that constitute the columns of a matrix, which we call as the
template, such that the magnitude of each combining coefficient is
bounded in its absolute value by a positive real, called a scaling factor.
%
\begin{definition}[Template complex zonotope]
Let us consider $\ptemp\in\mat{n}{m}{\compnums}$ called the template,
$\sfact\in\reals^m_{\geq 0}$ called scaling factors and
$\cen\in\compnums^n$ called the center.  Then the following is a template
complex zonotope.
%
\begin{equation}
\tcztope{\ptemp}{\cen}{\sfact}
= \set{\ptemp\zeta+\cen:~\absolute{\zeta_i}\leq \sfact_i~\forall
i\in\set{1,...,m}}.
\end{equation}
\end{definition}
%
The scaling factors of a template complex zonotope can be treated as
variables that can be adjusted to find better over-approximations of a
reachable set.  For example, Figure~\ref{toref} illustrates the
different over-approximations of a convex hull of five points by a
complex zonotopes with a fixed template but different scaling factors.

In the representation of a tempalte complex zonotope, the floating
point representation of the entries of the template, center vector and
scaling factors can be truncated to arbitrary lenghts depending on the
desired accuracy of representation.  So, in analyzing the complexity
of computations on a template complex zonotope, the number of rows and
columns of the template matrix is more relevant, which also determines
the size of center vector and scaling factors.  Henceforth, in further
discussions, by the {\it size of representation of a template complex
zonotope}, we refer to the number of rows and columns of the template
complex matrix.

{\color{red} Normalization}
%
\section{Operations on a template complex zonotope}
In the reachability analysis of affine hybrid systems, linear
transformation, Minkowski sum, inclusion-checking and intersection
with linear constraints are the essential operations used in the
computation of reachable sets.  In this section, we describe the
computation of linear transformation, Minkowski sum and
inclusion-checking for template complex zonotopes.  Complex zonotopes
are not closed under intersection with linear constraints.  We address
the issue of intersection with linear constraints in a latter chapter
by using a more general representation of complex zonotopes.

Template complex zonotopes are closed under linear transformation and
Minkowski sum operations and these are straightforward algebraic
computations, just like in the case of simple (real) zonotopes.
%
\begin{proposition}[Linear transformation: template complex zonotope]
Let $A\in\mat{n}{n}{\reals}$ and $\ptemp\in\mat{n}{m}{\compnums}$.
Given a template complex zonotope $\tcztope{\ptemp}{\cen}{\sfact}$, we
get another template complex zonotope after multiplying the former
template complex zonotope by the matrix $A$, which is computed as
follows. 
%
\begin{equation}
A\tcztope{\ptemp}{\cen}{\sfact}=\tcztope{A\ptemp}{A\cen}{\sfact}.
\end{equation}
%
\end{proposition}
%
\begin{proof}
First we shall show
$A\tcztope{\ptemp}{\cen}{\sfact}\subseteq\tcztope{A\ptemp}{A\cen}{\sfact}.$
Let $y\in\tcztope{\ptemp}{\cen}{\sfact}$.  Then $y=\ptemp\zeta+\cen$
for some $\zeta\in\compnums^m$ such that
$\absolute{\zeta}\leq \sfact$.  We have $Ay=A\ptemp\zeta+A\cen$.  So,
$Ay\in\tcztope{A\ptemp}{Ac}{\sfact}$.  Therefore,
$A\tcztope{\ptemp}{\cen}{\sfact}\subseteq\tcztope{A\ptemp}{A\cen}{\sfact}.$
 
Now we have to show $\tcztope{A\ptemp}{A\cen}{\sfact}\subseteq
A\tcztope{\ptemp}{\cen}{\sfact}$.  Let
$z\in\tcztope{A\ptemp}{Ac}{\sfact}$.  Then $z=A\ptemp\zeta^\pr+A\cen$
for some $\zeta^\pr\in\compnums^m$ such that
$\absolute{\zeta^\pr}\leq \sfact$.  Equivalently, $z=
A(\ptemp\zeta^\pr+\cen)$.  So, $z\in
A\tcztope{\ptemp}{\cen}{\sfact}$.  Therefore, $\tcztope{A\ptemp}{A\cen}{\sfact}\subseteq
A\tcztope{\ptemp}{\cen}{\sfact}$.
From the previous two conclusions, we have
$A\tcztope{\ptemp}{\cen}{\sfact}=\tcztope{A\ptemp}{A\cen}{\sfact}.$
\end{proof}
%
\begin{proposition}[Minkowski sum: template complex zonotopes]
Let $\tcztope{\ptemp}{\cen}{\sfact}$ and
$\tcztope{\ptemp^\pr}{\cen^\pr}{\sfact^\pr}$ be two template complex
zonotopes which are subsets of $\compnums^n$, i.e.,
$\cen,\cen^\pr\in\compnums^n$.  The Minkowski sum of the two
template complex zonotopes is another template complex zonotope,
which is computed as follows.
%
\begin{equation}
\minsum{\tcztope{\ptemp}{\cen}{\sfact}}{\tcztope{\ptemp^\pr}{\cen^\pr}{\sfact^\pr}}
= \tcztope{\begin{bmatrix}\ptemp & \ptemp^\pr\end{bmatrix}}{\cen+\cen^\pr}{\begin{bmatrix}\sfact\\\sfact^\pr\end{bmatrix}}
\end{equation}
\end{proposition}
%
\begin{proof}
First we shall show that \\$\minsum{\tcztope{\ptemp}{\cen}{\sfact}}{\tcztope{\ptemp^\pr}{\cen^\pr}{\sfact^\pr}}
\subseteq \tcztope{\begin{bmatrix}\ptemp
& \ptemp^\pr\end{bmatrix}}{\cen+\cen^\pr}{\begin{bmatrix}\sfact\\\sfact^\pr\end{bmatrix}}$.
Let $y\in\tcztope{\ptemp}{\cen}{\sfact}$ and
$y^\pr\in\tcztope{\ptemp^\pr}{\cen^\pr}{\sfact^\pr}$ such that
$y=\ptemp\zeta+\cen:\absolute{\zeta}\leq \sfact$ and
$y^\pr=\ptemp^\pr\zeta^\pr+\cen^\pr:\absolute{\zeta^\pr}\leq \sfact^\pr$
for some complex valued vectors $\zeta$ and $\zeta^\pr$.  Then
$y+y^\pr = \ptemp\zeta+\ptemp^\pr\zeta^\pr = \begin{bmatrix} \ptemp
& \ptemp^\pr\end{bmatrix}\begin{bmatrix} \zeta\\\zeta^\pr\end{bmatrix}$.
We have
$\absolute{\begin{matrix} \zeta\\\zeta^\pr\end{matrix}}\leq\begin{bmatrix}\sfact\\\sfact^\pr\end{bmatrix}$.
Therefore,
$\minsum{\tcztope{\ptemp}{\cen}{\sfact}}{\tcztope{\ptemp^\pr}{\cen^\pr}{\sfact^\pr}}
\subseteq \tcztope{\begin{bmatrix}\ptemp
& \ptemp^\pr\end{bmatrix}}{\cen+\cen^\pr}{\begin{bmatrix}\sfact\\\sfact^\pr\end{bmatrix}}$.
Next we have to show $\tcztope{\begin{bmatrix}\ptemp
& \ptemp^\pr\end{bmatrix}}{\cen+\cen^\pr}{\begin{bmatrix}\sfact\\\sfact^\pr\end{bmatrix}} \subseteq \minsum{\tcztope{\ptemp}{\cen}{\sfact}}{\tcztope{\ptemp^\pr}{\cen^\pr}{\sfact^\pr}}$.
Consider that $y\in\tcztope{\begin{bmatrix}\ptemp
& \ptemp^\pr\end{bmatrix}}{\cen+\cen^\pr}{\begin{bmatrix}\sfact\\\sfact^\pr\end{bmatrix}}$.
Then $y=\begin{bmatrix}\ptemp
&\ptemp^\pr\end{bmatrix}\begin{bmatrix}\zeta\\ \zeta^\pr\end{bmatrix}=\ptemp\zeta+\ptemp\zeta^\pr$
for some complex valued vectors $\zeta$ and $\zeta^\pr$ such that $\absolute{\zeta}\leq \sfact$ and
$\absolute{\zeta^\pr}\leq\sfact^\pr$.  So,
$y\in\minsum{\tcztope{\ptemp}{\cen}{\sfact}}{\tcztope{\ptemp^\pr}{\cen^\pr}{\sfact^\pr}}$.
Therefore, $\tcztope{\begin{bmatrix}\ptemp
& \ptemp^\pr\end{bmatrix}}{\cen+\cen^\pr}{\begin{bmatrix}\sfact\\\sfact^\pr\end{bmatrix}} \subseteq \minsum{\tcztope{\ptemp}{\cen}{\sfact}}{\tcztope{\ptemp^\pr}{\cen^\pr}{\sfact^\pr}}$.
From the previous two conclusions, we get
$\minsum{\tcztope{\ptemp}{\cen}{\sfact}}{\tcztope{\ptemp^\pr}{\cen^\pr}{\sfact^\pr}}
= \tcztope{\begin{bmatrix}\ptemp
& \ptemp^\pr\end{bmatrix}}{\cen+\cen^\pr}{\begin{bmatrix}\sfact\\\sfact^\pr\end{bmatrix}}$.
\end{proof}
%
{\color{red}
\begin{enumerate}
\item Minkowki sum with common templates.
\item Non-closure under intersection.
\item Over-approximation of sets. Provide figure.
\item Point inclusion in template complex zonotope.
\item Linear projection.
\end{enumerate}
}

In the above proposition, we see that that the size of the
representation of a template complex zonotope which is a Minkowski sum
of two template complex zonotopes is equal to the sum of the sizes of
latter.  Then based on Equation~\ref{toref}, the size of
representation of the reach set at any given discrete time in terms of
a template complex zonotope increases linearly as a function of time.
We shall explain this computation in a latter section.  However, we
observe that when the templates of two template complex zonotopes are
the same, then the size the size of the template matrix and the vector
of scaling factors of the representation of their Minkowski sum
remains the same.  Latter, we shall use this observation in
conjugation with the Lemma~\ref{} about eigenstructure based scaling
to derive an efficient reachable set computation method for linear
systems.  The aforementioned observation is explained below.
%
\begin{lemma}[Minkowski sum with common template]
Let
$\tcztope{\ptemp}{c}{s},\tcztope{\ptemp}{c^\pr}{s^\pr}\subseteq\reals^n$
be two template complex zonotopes.  Then
%
\begin{equation}~\label{eqn:common-minkowski}
\minsum{\tcztope{\ptemp}{c}{s}}{\tcztope{\ptemp}{c^\pr}{s^\pr}}=\minsum{\ptemp}{c+c^\pr}{s+s^\pr}
\end{equation}
%
\end{lemma}
%
While computing positive invariants using a set representation,
deciding the inclusion of a given set inside another set is necessary
for ascertaining the positive invariance of the latter.  In the case
of complex zonotopes, checking the exact inclusion is a non-convex
optimization problem.  However, we shall later propose a convex
relaxation, which is a sufficient condition for checking the
inclusion.  But first we show the non-convexity of the exact inclusion
checking problem.  Deciding the inclusion between any two complex
zonotopes amounts to solving the following optimization problem.

%
\begin{lemma}[Exact inclusion between template complex zonotopes]~\label{lem:exact-inclusion}
Consider two template complex zonotopes
$\tcztope{\ptemp}{\cen}{\sfact}$ and
$\tcztope{\ptemp^\pr}{\cen^\pr}{\sfact^\pr}$ such that
$\ptemp\in\mat{n}{m}{\compnums}$ and $\ptemp^\pr\in\mat{n}{r}{\compnums}$.  The inclusion
$\tcztope{\ptemp^\pr}{\cen^\pr}{\sfact^\pr}\subseteq\tcztope{\ptemp}{\cen}{\sfact}$
holds if and only if
\begin{equation}\label{eqn:exact-inclusion}
\max_{\set{\zeta^\pr\in\compnums^{r}:\absolute{\zeta^\pr}\leq \sfact^\pr}}\min_{\set{\zeta\in\compnums^m:\ptemp\zeta=\ptemp^\pr\zeta^\pr+\cen^\pr-\cen}}\max_{i=1}^m\lt(\absolute{\zeta_i}-s_i\rt)\leq 0
\end{equation}
\end{lemma}
%
\begin{proof}
We have
$\tcztope{\ptemp^\pr}{\cen^\pr}{\sfact^\pr}\subseteq\tcztope{\ptemp}{\cen}{\sfact}$
iff for every $\zeta^\pr\in\compnums^r:\absolute{\zeta^\pr}\leq \sfact^\pr$,
there exists
$\zeta\in\compnums^m:\ptemp\zeta+\cen=\ptemp^\pr\zeta^\pr+\cen^\pr~\wedge~\absolute{\zeta}\leq
\sfact$.  The former statement is expressed in terms of optimization
as \vspace{-2.2em}\[\hspace{10em}\max_{\set{\zeta^\pr\in\compnums^{r}:\absolute{\zeta^\pr}\leq \sfact^\pr}}\min_{\set{\zeta\in\compnums^m:\ptemp\zeta=\ptemp^\pr\zeta^\pr+\cen-\cen^\pr}}\max_{i=1}^m\lt(\absolute{\zeta_i}-s_i\rt)\leq
0. \]
\end{proof}
%

\section{Covex condition for inclusion checking}
Solving Equation~\ref{eqn:exact-inclusion} amounts to solving a
non-covex optimization problem, which can be inferred as follows.  If
$\ptemp\zeta=\ptemp\zeta^\pr+\cen^\pr+\cen$ has a solution $\zeta^*$,
then any other solution can be written as $\zeta^*+v$ such that $v$
belongs to the complex valued null-space of $\ptemp$.  The absolute
value of a complex variable is a convex quadratic function.  So, the
the
term \[\min_{\set{\zeta\in\compnums:\ptemp\zeta=\ptemp^\pr\zeta^\pr+\cen^\pr-\cen}}\max_{i=1}^m\lt(\absolute{\zeta_i}-s_i\rt)\]
is a point-wise minimum (for points represented by $\zeta$) of a set
of quadratic convex functions over $\zeta^\pr$, which is therefore
neither convex nor concave function of $\zeta^\pr$ in general.  So the
maximization
%
\[
\max_{\set{\zeta^\pr\in\compnums^{r}:\absolute{\zeta^\pr}\leq \sfact^\pr}}\min_{\set{\zeta\in\compnums^m:\ptemp\zeta=\ptemp^\pr\zeta^\pr+\cen^\pr-\cen}}\max_{i=1}^m\lt(\absolute{\zeta_i}-s_i\rt)
\]
%
is defined over a non-concave function, whose maximum can not be
computed by convex optimization.

However, we will derive a sufficient condition expressed as a set of
convex constraints on the center and scaling factors and some
additional variables, which would be sufficient to guarantee inclusion
between two complex zonotopes.  More precisely, we derive a class of
convex constraints called second order conic constraints that can be
solved efficiently using interior point methods~\cite{todo}.  We shall
first explain second order conic constraints before deriving
the convex condition for inclusion checking.
%
\begin{definition}[Second order conic constraint]
A second order conic constraint on a variable $x\in\reals^n$ is one of
the following expressions.
\begin{enumerate}
\item  $\sqnorm{a^Tx+b}\leq c^Tx+d$ where $a,c\in\reals^n$ and
$b,d\in\reals$ are constants.
\item $p^Tx=q$ where $p\in\reals^n$ and $q\in\reals$ are constants.
\end{enumerate}
\end{definition}
%
Given a set of second order conic constraints on a variable
$x\in\reals^n$, solving the constraints refers to finding a value of
$x^*\in\reals^n$ that satisfies the constraints.  A value
$x^\pr\in\reals^n$ is called an approximate solution within a
precision $\epsilon\in\reals_{\geq 0}$ if there exists a solution
$x^*\in\reals^n$ such that $\sqnorm{x^\pr-x^*}\leq \epsilon$.  There
are numerical algorithms based on interior point methods~\cite{todo}
that can efficiently find approximate solutions with very high
precision to second order conic constraints (SOCC).

Now we shall discuss the derivation of the set of convex constraints
as sufficient condition for inclusion-checking between two
complex-zonotopes.
%
\begin{lemma}~\label{lem:transfer-matrix}
  Let $\sfact\in\reals^m_{\geq 0}$, $\sfact^\pr\in\reals^r_{\geq 0}$
  and $\zeta^\pr\in\compnums^r$ such that
  $\absolute{\zeta^\pr}\leq\sfact^\pr$ and
  $\cen,\cen^\pr\in\compnums^n$.  Let $\ptemp\in\mat{n}{m}{\compnums}$
  and $\ptemp^\pr\in\mat{n}{r}{\compnums}$ such that $\ptemp\tmat=\ptemp^\pr\diagonal{\sfact^\pr}$ and
  $\ptemp\tvect=\lt(c^\pr-c\rt)$ for a complex matrix $X$ and a
  complex vector $y$.  Then,
  %
\begin{equation}\label{eqn:transfer-matrix}
\min_{\set{\zeta\in\compnums:\ptemp\zeta=\ptemp^\pr\zeta^\pr+\cen^\pr-\cen}}\max_{i=1}^m\lt(\absolute{\zeta_i}-\sfact_i\rt)\leq \max_{i=1}^m\lt(\absolute{\tvect_i}+\sum_{j=1}^r\absolute{\tmat_{ij}}-\sfact_i\rt).
\end{equation}
%
\end{lemma}
%
\begin{proof}
Consider $\epsilon\in\compnums^{r}$, where for any $i\in\set{1,...,r}$,
%
$\left\{
\begin{array}{l}
\epsilon_i=\frac{\zeta^\pr}{s^\pr_i}~\text{if}~ s^\pr_i\neq 0\\
\epsilon_i=0~\text{otherwise}
\end{array}
\right.$.
%
Since $\absolute{\zeta^\pr}\leq s^\pr$ as given, so
we have $\zeta^\pr=\diagonal{s^\pr}\epsilon$ and
$\max_{j=1}^r\absolute{\epsilon_j}\leq 1$.  By
using the relations given in the lemma, we henceforth get
%
\begin{align*}
&\ptemp^\pr\zeta^\pr+c-c^\pr
=\ptemp^\pr\diagonal{\sfact^\pr}\epsilon+c-c^\pr
=\ptemp\tmat\epsilon+\ptemp\tvect
=\ptemp\lt(\tmat\epsilon+\tvect\rt)
\end{align*}
%
Therefore,
%
\begin{align*}
& \min_{\set{\zeta\in\compnums:\ptemp\zeta=\ptemp^\pr\zeta^\pr+\cen^\pr-\cen}}\max_{i=1}^m\lt(\absolute{\zeta_i}-\sfact_i\rt)\leq \max_{i=1}^m\lt(\absolute{\lt(X\epsilon+y\rt)_i}-\sfact_i\rt)\\
&\leq \max_{i=1}^m\lt(\absolute{\tvect_i}+\sum_{j=1}^r\absolute{\tmat_{ij}}\absolute{\epsilon_j}-\sfact_i\rt)
~~\%\%~\text{Using triangular inequality}\\
& \leq  \max_{i=1}^m\lt(\absolute{\tvect_i}+\sum_{j=1}^r\absolute{\tmat_{ij}}-\sfact_i\rt)
~~\%\%~\text{Since}~\max_{j=1}^r\absolute{\epsilon_j}\leq 1.
\end{align*}
%
\end{proof}
%
Based on the above lemma, we define a relation between two template
complex zonotopes, which is a sufficient condition for the inclusion
relation.
%
\begin{definition}[Relation for inclusion-checking]
For two template complex zonotopes $\tcztope{\ptemp}{\cen}{\sfact}$
and $\tcztope{\ptemp^\pr}{\cen^\pr}{\sfact^\pr}$ such that
$\ptemp\in\mat{n}{m}{\compnums}$ and
$\ptemp^\pr\in\mat{n}{r}{\compnums}$, we say
$\tcztope{\ptemp}{\cen}{\sfact}\order\tcztope{\ptemp^\pr}{\cen^\pr}{\sfact^\pr}$
if all of the following are collectively true.
%
\begin{align*}
& \exists \tmat\in\mat{m}{r}{\compnums},\tvect\in\compnums^m~~\text{such
that}\\
& \ptemp\tmat=\ptemp^\pr\diagonal{\sfact^\pr},~~\ptemp\tvect=\cen^\pr-\cen\\
& \max_{i=1}^m\lt(\absolute{\tvect_i}+\sum_{j=1}^r\absolute{\tmat_{ij}}-\sfact_i\rt)\leq
0.
\end{align*}
%
\end{definition}
%
\begin{theorem}[Sufficient condition for inclusion checking]~\label{thm:suff-inclusion}
The inclusion\\
$\tcztope{\ptemp}{\cen}{\sfact}\subseteq\tcztope{\ptemp^\pr}{\cen^\pr}{\sfact^\pr}$
holds if the relation
$\tcztope{\ptemp}{\cen}{\sfact}\order\tcztope{\ptemp^\pr}{\cen^\pr}{\sfact^\pr}$
is true.
\end{theorem}
%
\begin{proof}
We have shown in Lemma~\ref{lem:exact-inclusion} that the inclusion
$\tcztope{\ptemp}{\cen}{\sfact}\subseteq\tcztope{\ptemp^\pr}{\cen^\pr}{\sfact^\pr}$
holds iff the L.H.S of Equation~\ref{eqn:exact-inclusion} is bounded
above by zero.  Based on Lemma~\ref{lem:transfer-matrix}, the R.H.S of
Equation~\ref{eqn:transfer-matrix} is an upper bound on the L.H.S of
Equation~\ref{eqn:exact-inclusion}.  So, if
$\tcztope{\ptemp}{\cen}{\sfact}\order\tcztope{\ptemp^\pr}{\cen^\pr}{\sfact^\pr}$,
then the R.H.S of Equation~\ref{eqn:transfer-matrix} would be
bounded above by zero and the condition for inclusion in
Equation~\ref{eqn:exact-inclusion} would be satisfied.
\end{proof}
%
%% Furthermore, the above relation is a partial order.
%
%% \begin{theorem}[Paritial ordering]
%% The relation ``$\order$'' between template complex zonotopes is a
%% partial order.  That is, for any three template complex zonotopes
%% $\tcz{\ptemp}{\cen}{\sfact}$, $\tcz{\ptemp^\pr}{\cen^\pr}{\sfact^\pr}$
%% and $\tcz{\ptemp^\dpr}{\cen^\dpr}{\sfact^\dpr}$, all of the following
%% conditions are true.
%% %
%% \begin{enumerate}
%% \item Reflexivity:
%% $\tcz{\ptemp}{\cen}{\sfact}\order\tcz{\ptemp}{\cen}{\sfact}$.
%% \item Antisymmetry: If
%% $\tcz{\ptemp}{\cen}{\sfact}\order\tcz{\ptemp^\pr}{\cen^\pr}{\sfact^\pr}$
%% and
%% $\tcz{\ptemp^\pr}{\cen^\pr}{\sfact^\pr}\order\tcz{\ptemp}{\cen}{\sfact}$,
%% then
%% $\tcz{\ptemp}{\cen}{\sfact}=\tcz{\ptemp^\pr}{\cen^\pr}{\sfact^\pr}$.
%% \item Transitivity: If
%% $\tcz{\ptemp^\pr}{\cen^\pr}{\sfact^\pr}\order\tcz{\ptemp}{\cen}{\sfact}$
%% and
%% $\tcz{\ptemp^\dpr}{\cen^\dpr}{\sfact^\dpr}\order\tcz{\ptemp^\pr}{\cen^\pr}{\sfact^\pr}$,
%% then $\tcz{\ptemp^\dpr}{\cen^\dpr}{\sfact^\dpr}\order\tcz{\ptemp}{\cen}{\sfact}$.
%% \end{enumerate}
%% %
%% \end{theorem}
%% %
%% \begin{proof}
%% \begin{enumerate}
%% \item {\it Reflexivity}:  Consider $\tmat=\diagonal{\sfact}$ and
%% $\tvect=\repmat{m}{1}$.  Then, 
%% $\ptemp\tmat=\ptemp\diagonal{\sfact}$,
%% $\ptemp\tvect=0=c-c$ and
%% %
%% \vspace{-1em}
%% \begin{align*}
%% & \max_{i=1}^m\lt(\absolute{y_i}+\sum_{j=1}^m\absolute{X_{ij}}-\sfact_i\rt)
%% =\max_{i=1}^m\lt(0+\sfact_i-\sfact_i\rt)=0\\
%% \end{align*}
%% %
%% So, $\tcz{\ptemp}{\cen}{\sfact}\order\tcz{\ptemp}{\cen}{\sfact}$.
%% \item {\it Antisymmetry}: Let
%% $\tcz{\ptemp}{\cen}{\sfact}\order\tcz{\ptemp^\pr}{\cen^\pr}{\sfact^\pr}$
%% and
%% $\tcz{\ptemp^\pr}{\cen^\pr}{\sfact^\pr}\order\tcz{\ptemp}{\cen}{\sfact}$.
%% By Theorem~\ref{thm:suff-inclusion}, this implies
%% $\tcz{\ptemp}{\cen}{\sfact}\subseteq\tcz{\ptemp^\pr}{\cen^\pr}{\sfact^\pr}$
%% and
%% $\tcz{\ptemp^\pr}{\cen^\pr}{\sfact^\pr}\subseteq\tcz{\ptemp}{\cen}{\sfact}$.
%% So,
%% $\tcz{\ptemp}{\cen}{\sfact}=\tcz{\ptemp^\pr}{\cen^\pr}{\sfact^\pr}$.
%% %
%% \item Consider that $\ptemp\in\mat{n}{m}{\compnums}$,
%% $\ptemp^\pr\in\mat{n}{r}{\compnums}$,
%% $\ptemp^\dpr\in\mat{n}{k}{\compnums}$ and the orderings
%% $\tcz{\ptemp}{\cen}{\sfact}\order\tcz{\ptemp^\pr}{\cen^\pr}{\sfact^\pr}$
%% and
%% $\tcz{\ptemp^\pr}{\cen^\pr}{\sfact^\pr}\order\tcz{\ptemp^\dpr}{\cen^\dpr}{\sfact^\dpr}$.
%% This implies,
%% %
%% \begin{align*}
%% & \exists \tmat\in\mat{m}{r}{\compnums},\tvect\in\compnums^m~~\text{such
%% that}\\
%% & \ptemp\tmat=\ptemp^\pr\diagonal{\sfact^\pr},~~\ptemp\tvect=\cen^\pr-\cen,\\
%% & \max_{i=1}^m\lt(\absolute{\tvect_i}+\sum_{j=1}^r\absolute{\tmat_{ij}}-\sfact_i\rt)\leq
%% 0
%% \end{align*}
%% %
%% and
%% \begin{align*}
%% & \exists \tmat^\pr\in\mat{m}{k}{\compnums},\tvect^\pr\in\compnums^m~~\text{such
%% that}\\
%% & \ptemp^\pr\tmat^\pr=\ptemp^\dpr\diagonal{\sfact^\dpr},~~\ptemp\tvect^\pr=\cen^\dpr-\cen^\pr,\\
%% & \max_{i=1}^m\lt(\absolute{\tvect^\pr_i}+\sum_{j=1}^k\absolute{\tmat^\pr_{ij}}-\sfact_i^\pr\rt)\leq
%% 0.
%% \end{align*}
%% %
%% Let $\tmat^\dpr=\tmat\tmat^\pr$ and $\tvect^\dpr=\tvect+\tvect^\pr$.
%% Then
%% \[
%% \ptemp\tmat^\dpr=\ptemp\tmat\tmat^\pr=
%% \]
%% \end{enumerate}
%% \end{proof}
%
If we consider the scaling factors and the center as variables, then
the above sufficient condition for inclusion-checking can be
efficiently reformulated as a set of second-order conic constraints on
the center, scaling factors and some auxillary variables.  This is
explained in the following proposition.
%
\begin{proposition}
If
$\cen,\cen^\pr\in\compnums^n,\sfact\in\reals^m,\sfact^\pr\in\reals^k$
are variables and\\
$\ptemp\in\mat{n}{m}{\compnums},\ptemp^\pr\in\mat{n}{k}{\compnums}$
are constants, the relation between template complex zonotopes
$\tcztope{\ptemp}{\cen}{\sfact}\order\tcztope{\ptemp^\pr}{\cen^\pr}{\sfact^\pr}$
can be expressed as a collection of $\lt(nk+n+m\rt)$ second order
conic constraints on a vector variable of size \\$\lt(mk+2n+2m+k\rt)$
comprising components of $\sfact,\sfact^\pr,\cen,\cen^\pr$ and some
additional variables.
\end{proposition}
%
\begin{proof}
{\color{red} TODO}
\end{proof}
%
Although the above relation is a sufficient condition for
inclusion-checking, it is also a necessary condition when the template
of the complex zonotope within which the containment is checked is
invertible.  This is explained in the following theorem.
%
\begin{theorem}
Let
$\tcztope{\ptemp}{\cen}{\sfact},\tcztope{\ptemp^\pr}{\cen^\pr}{\sfact^\pr}\subseteq\compnums^n$
be two complex zonotopes such that $\ptemp\in\mat{n}{n}{\compnums}$ is
an invertible square matrix.  Then
$\tcztope{\ptemp^\pr}{\cen^\pr}{\sfact^\pr}\subseteq\tcztope{\ptemp}{\cen}{\sfact}$
if and only if $\tcztope{\ptemp^\pr}{\cen^\pr}{\sfact^\pr}\order\tcztope{\ptemp}{\cen}{\sfact}$.
\end{theorem}
%
\begin{proof}
{\color{red} TODO}
\end{proof}

\section{Efficient reachable set computation for linear systems}

{\color{red}
\begin{enumerate}
\item Expression for bounded time reachable set.
\item Efficient representation using eigenvectors.
\item Computation of positive invariant.
\item Illustrative example.
\end{enumerate}
}
