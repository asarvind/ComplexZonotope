Before we introduce an augmented complex zonotope, we shall describe a
particular case when real zonotopes are closed under intersection with
sub-level sets of linear inequalities.  We introduce a slight
variation of the representation of a real zonotope, called
an \emph{interval zonotope}, so as to express the intersection by a
succinct algebraic expression.  In an interval zonotope, we specify
interval bounds on the combining coefficients, without explicitly
specifying the center.  However, we note that an interval zonotope is
geometrically the same as a real zonotope.
%
\begin{definition}[Interval Zonotope]
Let us consider $\stemp\in\mat{n}{k}{\reals}$, called the {\it
  template}, and $\lb,\ub\in\reals^k$ such that $\lb\leq \ub$, called
  the upper and lower interval bounds, respectively.  The following is
  the representation of an interval zonotope.
%
\[
\iztope{\stemp}{\lb}{\ub}:=\set{\stemp\zeta:~\zeta\in\reals^k,~\lb\leq\zeta\leq\ub}.
\]
%
\end{definition}
%
We consider a particular type of sub-level set of linear
inequalities, which we call as \emph{sub-parallelotope}, for which the
intersection with a suitably aligned interval zonotope gives another
interval zonotope.  Furthermore, the intersection can be computed by a
simple algebraic expression.  A sub-parallelotope can be seen as a
generalization of parallelotopes to possibly unbounded sets, which is defined
as follows.
%
\begin{definition}[Sub-parallelotope]
Let us consider ${\qtemp}\in\mat{k}{n}{\reals}$ such that
$\lt(\qtemp\transpose{\qtemp}\rt)$ is non-singular.  We
call such a matrix $\qtemp$ as a \emph{sub-paralleotopic template}.  Let us
consider
$\plb,\pub\in\lt(\reals\bigcup\set{-\infty,\infty}\rt)^k$ such that $\plb\leq\pub$,
called {\it lower and upper offsets}, respectively.  The following is
the representation of a sub-parallelotope.
%
\[
\ptope{\qtemp}{\plb}{\pub}:=\set{x\in\reals^n:~\plb\leq\qtemp x\leq\pub}.
\]
%
\end{definition}
%
In other words, a sub-level set of a set of linear inequalities is a
sub-parallelotope when the linear functions on which the inequalities
are defined are linearly independent. For example, because the row
vectors $\lt[\begin{matrix}1 & 1 & -1 \end{matrix}\rt]$ and
$\mymatrix{1 & -1 & 1}$ are linearly
independent, the sub-level set of
the linear inequalities
%
\begin{align*}
-1\leq x+y-z\leq 1\\
x-y+z\leq 3
\end{align*}
%
can be specified as a sub-parallelotope
%
\[
\ptope{\lt[\begin{matrix}
    1 & 1 & -1\\
    1 & 1 & 1
  \end{matrix}
  \rt]}
{\lt[
    \begin{matrix}
      -1\\
      -\infty
    \end{matrix}
    \rt]
}
{\left[
    \begin{matrix}
      1\\
      3
    \end{matrix}
    \right]
}.
\]
  On the other hand, the
sub-level set of
%
\begin{align*}
  -1\leq x+y-z\leq 1\\
  x+y+z\leq 2\\
  -1\leq x+y
\end{align*}
%
is not a sub-parallelotope, because there is linear dependence among
the row vectors $\lt[\begin{matrix} 1 & 1 & -1\end{matrix}\rt]$,
$\lt[\begin{matrix} 1 & 1 & 1\end{matrix}\rt]$, and
$\lt[\begin{matrix} 1 & 1 & 0 \end{matrix}\rt]$.

Similar to a zonotope, a sub-parallelotope has a generator
representation, as described in the following lemma.  However,
the center of the representation can take arbitrary values in the null
space of the sub-parallelotopic template.
%
\begin{lemma}~\label{lem:ptope-iz-conversion}
  Let $\qtemp\in\mat{k}{n}{\reals}$ be a sub-parallelotopic template.
  Then,
  %
  \[
  \ptope{\qtemp}{\plb}{\pub}=\set{\cen+\pinv{\qtemp}\zeta:~c\in\reals^n,\zeta\in\reals^k,~\qtemp
  \cen=0,~\plb\leq
  \zeta\leq \pub
  }.
  \]
%
\end{lemma}
%
\begin{proof}
Let $\zeta\in\reals^k$.  As $\qtemp{\pinv{\qtemp}\zeta}=\zeta$,
by the rank-nullity theorem we get
%
\begin{align*}
& \set{x\in\reals^n:\qtemp x=\zeta}=\set{c+\pinv{\qtemp}\zeta:\qtemp c=0}.\\
& \text{So,}~~\set{x\in\reals^n:\qtemp x=\zeta}=\set{c+\pinv{\qtemp}\zeta:~\qtemp c=0}.\\
& \text{Then,} ~~\ptope{\qtemp}{\plb}{\pub} = \set{x\in\reals^n:~\plb\leq \qtemp x\leq\pub}\nonumber\\
& = \set{x\in\reals^n:\qtemp
  x=\zeta, \plb\leq \zeta\leq\pub}\nonumber\\
& = \set{c+\pinv{\qtemp}\zeta:\qtemp c=0,~\plb\leq\zeta\leq\pub}.\hspace{5em}\qedhere
\end{align*}
%
\end{proof}
%
The above similarity between sub-parallelotopes and interval
zonotopes provides an intuition that interval zonotopes can be
closed under intersection with suitably aligned
sub-parallelotopes.  In fact, we observe that when a
sub-parallelotope has its template aligned with that of an interval
zonotope, their intersection can be exactly represented by another
interval zonotope.  As an example, the intersection of
%
\begin{align*}
& \iztope{\lt[\begin{array}{l l}1 & 0 \\ 0 &
      1\end{array}\rt]}{\lt[\begin{array}{c}-1\\ -1\end{array}\rt]}{\lt[\begin{array}{c}2\\ 2\end{array}\rt]}\\
&\text{with the sub-level sets of: }~
x_1\leq 1,\hspace{1em}
  x_2\geq 0.5,\\
&\text{which is the sub-parallelotope}~~~~ \ptope{\mymatrix{1&
  0\\0&1}}{\mymatrix{-\infty& 0.5}}{\mymatrix{1&\infty}}\\
& \text{gives}~~~\iztope{\lt[\begin{array}{l
        l}1 & 0 \\ 0 &
      1\end{array}\rt]}{\lt[\begin{array}{c}-1\\ 0.5\end{array}\rt]}{\lt[\begin{array}{c}1\\ 2\end{array}\rt]}.
\end{align*}
%
In the general case, we express the intersection between a
a sub-parallelotope and a possibly translated interval
zonotope as follows.
%
\begin{lemma}~\label{lem:motivation}
  Let $\qtemp\in\mat{k}{n}{\reals}$ be a sub-parallelotopic template
  and  ${c\in\reals^n}$.
%
\begin{align}~\label{eqn:motivation}
& \text{Then}~~\lt(\cen+\iztope{\pinv{\qtemp}}{\lb}{\ub}\rt)\bigcap\ptope{\qtemp}{\plb}{\pub}\nonumber\\
& =\cen+\iztope{\pinv{\qtemp}}{\join{\lb}{\lt(\plb-\qtemp\cen\rt)}}{\meet{\ub}{\lt(\pub-\qtemp\cen\rt)}}.
\end{align}
%
\end{lemma}
%
\begin{proof}
Let us denote
$S_1=\lt(\cen+\iztope{\pinv{\qtemp}}{\lb}{\ub}\rt)\bigcap\ptope{\qtemp}{\plb}{\pub}$
and\\
$S_2=\cen+\iztope{\pinv{\qtemp}}{\join{\lb}{\lt(\plb-\qtemp\cen\rt)}}{\meet{\ub}{\lt(\pub-\qtemp\cen\rt)}}$.
We shall first prove that $S_1\subseteq S_2$.  Let us consider that
$x\in S_1$.  So, $x\in\ptope{\qtemp}{\plb}{\pub}$ and
%
\[
\exists
\zeta\in\reals^k:~x=\cen+\pinv{\qtemp}\zeta,~\lb\leq\zeta\leq\ub.
\]
%
Then we get
%
\begin{align*}
& \plb\leq\qtemp x\leq \pub~~
 \equivalent~~ \plb\leq \qtemp\lt(\cen+\pinv{\qtemp}\zeta\rt)\leq \pub\\
& \equivalent~~ \plb-\qtemp\cen\leq\zeta\leq\pub-\qtemp\zeta.
\end{align*}
%
Also, we have $\lb\leq \zeta\leq \ub$ as given previously.
Therefore,
\[\join{\lb}{\lt(\plb-\qtemp\cen\rt)}\leq\zeta\leq\meet{\ub}{\lt(\pub-\qtemp\cen\rt)}.\]
As $x=\cen+\pinv{\qtemp}\zeta$, the above constraint implies $x\in S_2$.  This shows that $S_1\subseteq S_2$.

Now, we shall prove $S_2\subseteq S_1$.  Since
\begin{align}
&\lb\leq\join{\lb}{\lt(\plb-\qtemp\cen\rt)}~~\text{and}~~\meet{\ub}{\lt(\pub-\qtemp\cen\rt)}\leq
\ub,~~\text{we derive}\nonumber\\
&
S_2=\cen+\iztope{\pinv{\qtemp}}{\join{\lb}{\lt(\plb-\qtemp\cen\rt)}}{\meet{\ub}{\lt(\pub-\qtemp\cen\rt)}}
\subseteq \cen+\iztope{\pinv{\qtemp}}{\lb}{\ub}~\label{eqn:proof-motivation1}
\end{align}
%
Now, let us consider a point $y\in S_2$.  So, $\exists
\zeta^\pr\in\reals^k:$
%
\begin{align*}
& y=\cen+\pinv{\qtemp}\zeta^\pr,~\join{\lb}{\lt(\plb-\qtemp\cen\rt)}\leq\zeta^\pr
\leq\meet{\ub}{\lt(\pub-\qtemp\cen\rt)}.\\
& \text{Then}~~
\qtemp y=\qtemp\lt(\cen+\pinv{\qtemp}\zeta^\pr\rt)=\qtemp\cen+\zeta^\pr\\
& \%\%~~\text{since}~\join{\lb}{\lt(\plb-\qtemp\cen\rt)}\leq\zeta^\pr\leq
\meet{\ub}{\lt(\pub-\qtemp\cen\rt)}\\
& \implies \qtemp\cen+\lt(\plb-\qtemp\cen\rt)\leq\qtemp y\leq
\qtemp\cen+\lt(\pub-\qtemp\cen\rt)\\
& \implies \plb\leq\qtemp y\leq\pub.
\end{align*}
%
Therefore, $y\in\ptope{\qtemp}{\plb}{\pub}$.  This shows that
$S_2\subseteq \ptope{\qtemp}{\plb}{\pub}$.  Using this result along with
Equation~\ref{eqn:proof-motivation1}, we get that $S_2\subseteq S_1$.
We have also shown earlier that ${S_1\subseteq S_2}$.  Therefore, $S_1=S_2$.
\end{proof}
%


\input{chapters/sections-ch-acz/intersection1}


\subsubsection*{Other computations on interval zonotopes}
%
An interval zonotope can be equivalently specified as the real
projection of a template complex zonotope, as described in the
following lemma.  We use this result to compute other operations on
interval zonotopes, like linear transformation, Minkowski sum,
inclusion-checking and support function.
%
\begin{lemma}~\label{lem:iz-tcz-conversion}
The following is true.
%
\[
\iztope{\stemp}{\lb}{\ub}=\real\lt(\tcztope{\stemp}{\stemp\frac{\ub+\lb}{2}}{\frac{\ub-\lb}{2}}\rt).
\]
%
\end{lemma}
%
\begin{proof}
Let us consider a point $x\in\iztope{\stemp}{\lb}{\ub}$ expressed as
%
\[
x=\stemp\zeta:\zeta\in\reals^n,\lb\leq\zeta\leq\ub.
\]
%
  Let $\zeta^\pr=
\zeta-\frac{\ub+\lb}{2}$.
Then we get,
%
\begin{align*}
& x=\stemp\zeta=\stemp\frac{\ub+\lb}{2}+\stemp\lt(\zeta-\frac{\ub+\lb}{2}\rt)\\
& = \stemp\frac{\ub+\lb}{2}+\stemp\zeta^\pr~~\text{and}\\
& \absolute{\zeta^\pr}=\absolute{\zeta-\frac{\ub+\lb}{2}}\\
& \%\%~\text{As $\zeta$ is a real vector and $\lb\leq\zeta\leq\ub$}\\
& \leq \join{\absolute{\lb-\frac{\ub+\lb}{2}}}{\absolute{\ub-\frac{\ub+\lb}{2}}}
= \absolute{\frac{\ub-\lb}{2}}.
\end{align*}
%
So,
$x\in\real\lt(\tcztope{\stemp}{\stemp\frac{\ub+\lb}{2}}{\frac{\ub-\lb}{2}}\rt)$.  Therefore,
%
\[
\iztope{\stemp}{\lb}{\ub}\subseteq\real\lt(\tcztope{\stemp}{\stemp\frac{\ub+\lb}{2}}{\frac{\ub-\lb}{2}}\rt).
\]
%
Next consider $y\in\real\lt(\tcztope{\stemp}{\stemp\frac{\ub+\lb}{2}}{\frac{\ub-\lb}{2}}\rt)$,
expressed as
\[
y=\stemp\zeta+\stemp\frac{\ub+\lb}{2}:~\absolute{\zeta}\leq\frac{\ub-\lb}{2}.
\]
%
Let $\zeta^\dpr=\zeta+\frac{\ub+\lb}{2}$.
As
$\absolute{\zeta}\leq\frac{\ub-\lb}{2}$, so we get
%
\begin{align*}
&
\frac{\ub+\lb}{2}-\frac{\ub-\lb}{2}\leq\zeta^\dpr\leq\frac{\ub-\lb}{2}+\frac{\ub+\lb}{2}\\
& \equivalent \lb\leq\zeta^\dpr\leq\ub
\end{align*}
%
Furthermore, $y=\stemp\zeta+\stemp\frac{\ub+\lb}{2}=\stemp\zeta^\dpr$.
So, $y\in\iztope{\stemp}{\lb}{\ub}$.  Therefore,
%
\[
\iztope{\stemp}{\lb}{\ub}\supseteq\real\lt(\tcztope{\stemp}{\stemp\frac{\ub+\lb}{2}}{\frac{\ub-\lb}{2}}\rt).
\]
%
Combining the previous two conclusions about the set inclusions, we get
%
\[
\iztope{\stemp}{\lb}{\ub}=\real\lt(\tcztope{\stemp}{\stemp\frac{\ub+\lb}{2}}{\frac{\ub-\lb}{2}}\rt).~~~~~~\qedhere
\]
%
\end{proof}
%
An interval zonotope can be equivalently represented as a simple
zonotope, which is stated in the following lemma.
%
\begin{lemma}~\label{lem:iz-rz-conversion}
The following is true.
%
\[
\iztope{\stemp}{\lb}{\ub}=\rztope{\stemp\diagonal{\frac{\ub-\lb}{2}}}{\stemp\frac{\ub+\lb}{2}}.
\]
%
\end{lemma}
%
\begin{proof}
Based on Lemma~\ref{lem:iz-tcz-conversion}, we have 
%
\[
\iztope{\stemp}{\lb}{\ub}=\real\lt(\tcztope{\stemp}{\stemp\frac{\ub+\lb}{2}}{\frac{\ub-\lb}{2}}\rt).
\]
%
Next based on Lemma~\ref{lem:normalization}, we have 
%
\[
\tcztope{\stemp}{\stemp\frac{\ub+\lb}{2}}{\frac{\ub-\lb}{2}}=\cztope{\ptemp\diagonal{\frac{\ub-\lb}{2}}}{\stemp\frac{\ub-\lb}{2}}.
\]
%
As $\ptemp$ is real, so
%
\[
\real\lt(\cztope{\ptemp\diagonal{\frac{\ub-\lb}{2}}}{\stemp\frac{\ub-\lb}{2}}\rt)=\rztope{\ptemp\diagonal{\frac{\ub-\lb}{2}}}{\stemp\frac{\ub-\lb}{2}}.
\]
%
Combining the above results, we get
\[
\iztope{\stemp}{\lb}{\ub}=\rztope{\stemp\diagonal{\frac{\ub-\lb}{2}}}{\stemp\frac{\ub+\lb}{2}}.~~~~\qedhere
\]
%
\end{proof}
%
Interval zonotopes are closed under linear transformation and
Minkowski sum operations.  The parameters of the resultant interval
zonotopes are an affine transformation of the original parameters.
This is described in the following lemmas.
%
\begin{lemma}[Linear transformation]~\label{lem:iz-lin-transform}
Let us consider $A\in\mat{n}{n}{\reals^n}$.  Then,
%
\[
A\iztope{\stemp}{\lb}{\ub}=\iztope{A\stemp}{\lb}{\ub}.
\]
%
\end{lemma}
%
\begin{proof}
Based on Lemma~\ref{lem:iz-rz-conversion}, we get
%
\begin{align*}
&  A\iztope{\stemp}{\lb}{\ub}
 =
  A\rztope{\stemp\diag{\frac{\ub-\lb}{2}}}{\frac{\ub+\lb}{2}}\\
  & ~~\%\%~~\text{by Lemma~\ref{lem:lin-rz}}\\
  & = \rztope{A\stemp\diag{\frac{\ub-\lb}{2}}}{\frac{\ub+\lb}{2}}\\
  & ~~\%\%~~\text{by Lemma~\ref{lem:iz-rz-conversion}}\\
  & = \iztope{A\stemp}{\lb}{\ub}.~~~~~\qedhere
\end{align*}
%
\end{proof}
%
\begin{lemma}[Minkowski sum]~\label{lem:iz-min-sum}
The following is true.
%
\[
\minsum{\iztope{\stemp}{\lb}{\ub}}{\iztope{\stemp^\pr}{\lb^\pr}{\ub^\pr}}
= \iztope{\mymatrix{\stemp &
    \stemp^\pr}}{\mymatrix{\lb\\\lb^\pr}}{\mymatrix{\ub\\\ub^\pr}}. 
\]
%
\end{lemma}
%
\begin{proof}
By Lemma~\ref{lem:iz-rz-conversion}, we get
%
\begin{align*}
  &
  \minsum{\iztope{\stemp}{\lb}{\ub}}{\iztope{\stemp^\pr}{\lb^\pr}{\ub^\pr}}\\
  & =
  \minsum{\rztope{\stemp\diag{\frac{\ub-\lb}{2}}}{\frac{\ub+\lb}{2}}}{\rztope{\stemp\diag{\frac{\ub^\pr-\lb^\pr}{2}}}{\frac{\ub^\pr+\lb^\pr}{2}}}\\
  & \%\%~~\text{by Lemma~\ref{lem:min-rz}}\\
  &= \rztope{\mymatrix{\stemp\diag{\frac{\ub-\lb}{2}} &
      \stemp^\pr\diag{\frac{\ub^\pr-\lb^\pr}{2}}}}{\frac{\ub+\lb}{2}+\frac{\ub^\pr+\lb^\pr}{2}}\\
  & = \rztope{\mymatrix{
      \stemp & \stemp^\pr
      }
    \diag{
      \frac{
        \mymatrix{
\ub\\\ub^\pr
          }-\mymatrix{
\lb\\\lb^\pr
          }
      }{2}
    }
    }{\frac{
        \mymatrix{
\ub\\\ub^\pr
          }+\mymatrix{
\lb\\\lb^\pr
          }
    }{2}}\\
  & \%\%~~\text{by Lemma~\ref{lem:iz-rz-conversion}}\\
  & = \iztope{\mymatrix{\stemp &
    \stemp^\pr}}{\mymatrix{\lb\\\lb^\pr}}{\mymatrix{\ub\\\ub^\pr}}.~\hspace{8em}\qedhere
\end{align*}
\end{proof}
%
The support of an interval zonotope along a vector is an affine
function of the lower and upper interval bounds, which is stated in
the following proposition.
%
\begin{lemma}[Support of a vector]~\label{lem:support-iz}
Let $v\in\reals^n$.  Then
%
\[
\supp{v}{\iztope{\stemp}{\lb}{\ub}}=v^T\stemp\lt(\frac{\ub+\lb}{2}\rt)+\absolute{v^T\stemp}\lt({\frac{\ub-\lb}{2}}\rt).
\]
%
\end{lemma}
%
\begin{proof}
By Lemma~\ref{lem:iz-tcz-conversion}, we get
%
\begin{align*}
  & \supp{v}{\iztope{\stemp}{\lb}{\ub}} = \supp{v}{\real\lt(\tcztope{\stemp}{\frac{\ub+\lb}{2}}{{\frac{\ub-\lb}{2}}}\rt)}\\
  & \%\%~~\text{by Lemma~\ref{lem:support-tcz}}\\
  & v^T\stemp\lt(\frac{\ub+\lb}{2}\rt)+\absolute{v^T\stemp}\lt({\frac{\ub-\lb}{2}}\rt).~\hspace{8em}\qedhere
\end{align*}
%
\end{proof}
%

























































