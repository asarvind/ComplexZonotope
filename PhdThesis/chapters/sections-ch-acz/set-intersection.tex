We shall now introduce the augmented complex zonotope set
representation and describe the over-approximation of its intersection
with a sub-parallelotope.  In Lemma~\ref{lem:motivation}, we have shown that the
intersection of a suitably aligned interval zonotope with a
sub-parallelotope can be computed exactly by a simple algebraic
formula.  Motivated by this, we specify an augmented complex zonotope
as a Minkowski sum of a template complex zonotope and an interval
zonotope.  The idea behind such a representation is that the interval
zonotope part is used to compute the intersection with a
sub-parallelotope, while the template complex zonotope may capture
positive invariance based on complex eigenstructure.  We will
mathematically formalize this idea latter.
%
\begin{definition}
Let us consider a template complex zonotope
$\tcztope{\ptemp}{\cen}{\sfact}\subseteq\compnums^n$ and an interval
zonotope $\iztope{\stemp}{\lb}{\ub}\subseteq\reals^n$.  Then the
following is the representation of an augmented complex zonotope.
%
\[
\acztope{\ptemp}{\cen}{\sfact}{\stemp}{\lb}{\ub}=\minsum{\tcztope{\ptemp}{\cen}{\sfact}}{\iztope{\stemp}{\lb}{\ub}}.
\]
%
\end{definition}
%
In this section, we shall consider
%
\begin{align*}
& \lb,\ub\in\reals^k:
k<n,~~~\plb\in\set{\reals,-\infty}^n,~~~\pub\in\set{\reals,\infty}^n\\
& \ptemp\in\mat{n}{m}{\compnums},~~~\qtemp\in\mat{k}{n}{\reals}:~\lt(\qtemp\qtemp^T\rt)~\text{is
non-singular}\\
& \sfact\in\reals_{\geq 0}^m,~~\cen\in\compnums^n.      
\end{align*}
%
Recall that an augmented
complex zonotope is a Minkowski sum of a template complex zonotope and
an interval zonotope, i.e.,
%
\[
\acztope{\ptemp}{\cen}{\sfact}{\stemp}{\lb}{\ub}=\minsum{\tcztope{\ptemp}{\cen}{\sfact}}{\iztope{\stemp}{\lb}{\ub}}.
\]
%
According to Lemma~\ref{lem:motivation}, the intersection of a
sub-parallelotope $\ptope{\qtemp}{\plb}{\pub}$ with an interval
zonotope $\iztope{\stemp}{\lb}{\ub}$ can be computed by a simple
algebraic formula when $\stemp=\pinv{\qtemp}$.  To extend this, we
want to find a condition such that we can over-approximate the
intersection of an augmented complex zonotope and a sub-parallelotope
%
\begin{align*}
& \intersection{\acztope{\ptemp}{\cen}{\sfact}{\pinv{\qtemp}}{\lb}{\ub}}{\ptope{\qtemp}{\plb}{\pub}}\\
& =\intersection{\lt(\minsum{\tcztope{\ptemp}{\cen}{\sfact}}{\iztope{\pinv{\qtemp}}{\lb}{\ub}\rt)}}{\ptope{\qtemp}{\plb}{\pub}}
\end{align*}
%
by another augmented complex zonotope given as
%
\begin{align*}
& \minsum{\tcztope{\ptemp}{\cen}{\sfact}}{\intersection{\lt(\iztope{\pinv{\qtemp}}{\lb}{\ub}}{\ptope{\qtemp}{\plb}{\pub}\rt)}}\\
& =
  \minsum{\tcztope{\ptemp}{\cen}{\sfact}}{\iztope{\pinv{\qtemp}}{\join{\lb}{\plb}}{\meet{\ub}{\pub}}}\\
& = \acztope{\ptemp}{\cen}{\sfact}{\pinv{\qtemp}}{\join{\lb}{\plb}}{\meet{\ub}{\pub}},
\end{align*}
%
That is, we first compute the intersection of
sub-parallelotope with the interval zonotope (which can be done
efficiently) and then take the Minkowski sum with the template complex
zonotope.  We shall derive a condition when the resultant augmented
complex zonotope is a valid over-approximation of the intersection.

Let us denote for any $i\in\set{0,...,n}$, $\idvec{i}$ as follows.
For any $j\in\set{1,...,n}$, $\lt(\idvec{i}\rt)_j=1$ if $i=j$ and $0$
otherwise.  Note that $\idvec{0}=\repmat{0}{n}{1}$.  Let us consider
that $Y\in\mat{n}{n-k}{\reals}$ as a basis for $\nullspace{\qtemp}$
when $k<n$.  If $k=n$ then $Y=0$.  For any $\alpha\in\reals^n$, let us
define $\ind{\alpha}\in\reals^n$ as follows.
%
\[
\forall i\in\set{1,...,n}:~\ind{\alpha}=
\lt\{\begin{array}{l}
0~~\text{if}~\supp{\alpha_i}{\lt(\plb_i,\pub_i\rt)}<\infty~\text{and}~i\leq k\\
1~~\text{otherwise}.
\end{array}
\right.
\]
%
In the lemma, we write a vector in terms of the basis
$\mymatrix{\transpose{\qtemp} & Y}$.  We denote
$\Psi_1=\acztope{\ptemp}{\cen}{\sfact}{\pinv{\qtemp}}{\plb}{\pub}$ and
$\Psi_2=\ptope{\pinv{\qtemp}}{\plb}{\pub}$.
%
\begin{lemma}[Intersection with Minkowski sum]~\label{lem:minsum-intersection}
Let us consider $S\in\reals^n$ and
%
\begin{align*}
& \forall i\in\set{1,...,k}~\lt(\identity{n}{n}-\diagonal{\idvec{i}}\rt)\mymatrix{\qtemp\\ Y^T}S\subseteq\mymatrix{\qtemp\\ Y^T}S~\numberthis\label{eqn:intersection3}\\
& \lb\leq\maxapprox{\lb}{\plb}\leq\minapprox{\ub}{\pub}\leq\ub~\numberthis\label{eqn:intersection4}.
\end{align*}
%
Then,
\begin{align*}
& \mymatrix{0\\ Y^T}S \oplus\mymatrix{\qtemp\\
 Y^T}\iztope{\pinv{\qtemp}}{\maxapprox{\lb}{\plb}}{\minapprox{\ub}{\pub}}
 \\ & \subseteq\mymatrix{\qtemp\\
 Y^T}\lt(\lt(S\oplus \iztope{\pinv{\qtemp}}{\lb}{\ub}\rt)\bigcap\ptope{\qtemp}{\plb}{\pub}\rt)~\numberthis\label{eqn:intersection1}\\
 &\subseteq \mymatrix{\qtemp\\
 Y^T}\lt(S \oplus\iztope{\pinv{\qtemp}}{\maxapprox{\lb}{\plb}}{\minapprox{\ub}{\pub}}\rt).\numberthis~\label{eqn:intersection2}
\end{align*}
%
\end{lemma}
%
\begin{proof}

First we shall prove Equation~\ref{eqn:intersection1}.
By Equation~\ref{eqn:intersection3}, we get $0\in\qtemp S$.  So,
%
\[
\mymatrix{0\\ Y^T}S\subseteq\mymatrix{\qtemp\\ Y^T}S.
\]
%
By
Equation~\ref{eqn:intersection4} we get
\[
\mymatrix{\qtemp\\Y^T}\iztope{\pinv{\qtemp}}{\meet{\lb}{\plb}}{\join{\ub}{\pub}}\subseteq\mymatrix{\qtemp\\Y^T}\iztope{\pinv{\qtemp}}{\lb}{\ub}.
\]
%
Henceforth, Equation~\ref{eqn:intersection1} follows from the above two results.

Next we shall prove Equation~\ref{eqn:intersection2}.

Let us consider
\[
x=v+\pinv{\qtemp}\in \lt(S\oplus \iztope{\pinv{\qtemp}}{\lb}{\ub}\rt)\bigcap\ptope{\qtemp}{\plb}{\pub}v\in
S
\]
%
where
$\pinv{\qtemp}\zeta\in \iztope{\pinv{\qtemp}}{\lb}{\ub}:~\lb\leq\zeta\leq\ub$.  Since
$x\in\ptope{\qtemp}{\plb}{\pub}$, we get
%
\begin{equation}~\label{proof-intersection1}
\forall i\in\set{1,...,n}~\plb_i\lt(\qtemp v\rt)_i+\zeta_i\leq\pub_i
\end{equation}
%
Let us consider
\begin{align*}
& \epsilon\in\reals^k:~\epsilon_i=\lt\{\begin{array}{l}
\min\set{\ub_i,\pub_i}~\text{if}~\zeta_i>\max\set{\ub_i,\pub_i}\\
\max\set{\lb_i,\plb_i}~\text{if}~\zeta_i<\max\set{\lb_i,\plb_i}\\
\zeta_i~\text{otherwise}.
\end{array}
\rt.\\
\end{align*}
%
By the above definition,
$\join{\lb}{\plb}\leq \epsilon\leq\meet{\ub}{\pub}$.  

Let us consider $w=v+\pinv{\qtemp}\zeta-\pinv{\qtemp}\epsilon$.   For
any $i\in \set{1,...,k}$, let us consider the following cases.

{\it Case 1:}  Let us consider that
$\zeta_{i}>\min\set{\ub_{i},\pub_{i}}$.  Then, $\epsilon_{i}=\min\set{\ub_{i},\pub_{i}}$.
%
\begin{equation}~\label{proof-intersection2}
\zeta_i-\epsilon_i\geq \min\set{\ub_{i},\pub_{i}}-\min\set{\ub_{i},\pub_{i}}=0.
\end{equation}
%
\begin{align*}
&\qtemp_i w
=(\qtemp)_i\lt(v+\pinv{\qtemp}\zeta-\pinv{\qtemp}\epsilon\rt)=\qtemp_iv+\zeta_i-\epsilon_i
& \%\%~\text{Using Equations~\ref{proof-intersection1}
and~\ref{proof-intersection2} we get}\\
& \qtemp_iv\leq \lt(\mymatrix{\qtemp \\ Y^T}w\rt)_i
\leq 0.
\end{align*}
%
{\it Case 2:}  Let us consider that
$\zeta_{i}<\max\set{\lb_{i},\plb_{i}}$.  Then, $\epsilon_{i}=\max\set{\lb_{i},\plb_{i}}$.
%
\begin{equation}~\label{proof-intersection2}
\zeta_i-\epsilon_i\leq \max\set{\lb_{i},\plb_{i}}-\max\set{\ub_{i},\pub_{i}}=0.
\end{equation}
%
\begin{align*}
& \qtemp_iw
=(\qtemp)_i\lt(v+\pinv{\qtemp}\zeta-\pinv{\qtemp}\epsilon\rt)=\qtemp_iv+\zeta_i-\epsilon_i
& \%\%~\text{Using Equations~\ref{proof-intersection1}
and~\ref{proof-intersection2} we get}\\
& 0\leq \lt(\mymatrix{\qtemp \\ Y^T}w\rt)_i
\leq \qtemp_i v
\end{align*}
%
{\it Case 3:}  Let us consider that both the above two cases are not
true.  Then $\epsilon_i=\zeta_i$.  So,
$\qtemp_iw=\qtemp_iv+\epsilon_i-\zeta_i=0$.

From the result in the above three cases, we get that
%
\begin{equation}~\label{proof-intersection3}
\forall
i\in\set{1,...,k}, \qtemp w\in\prod_{i=1}^k\convexhull{0,\qtemp_i v}
\end{equation}
%
Since 
$
\forall
i\in\set{1,...,k}~\lt(\identity{n}{n}-\diagonal{\idvec{i}}\rt)\qtemp
S\subseteq S$ and $S$ is a convex set, we get
$\prod_{i=1}^k\convexhull{0,v_i}\subseteq \qtemp S$.  Then by
Equation~\ref{proof-intersection3}, we get that $\qtemp w\in S$.

Next
%
\begin{align*}
& Y^T
w=Y\lt(v+\pinv{\qtemp} \epsilon-\pinv{\qtemp}\rt)\\
& \%\%~\text{since column vectors of $Y$ are in the null space of $\qtemp$}\\
& = Y v \in Y S\numberthis\label{proof-intersection4}
\end{align*}

Since, $\mymatrix{\qtemp\\ Y^T}x=\mymatrix{\qtemp\\
Y^T}\lt(x-\qtemp\epsilon\rt)$ where
$\join{\lb}{\plb}\leq\epsilon\leq\meet{\ub}{\pub}$ and
$\mymatrix{\qtemp\\ Y^T}w\in\mymatrix{\qtemp\\ Y^T}S$, we get that
$\mymatrix{\qtemp\\ Y^T}x\in\lt(S
 \oplus\iztope{\pinv{\qtemp}}{\join{\lb}{\plb}}{\meet{\ub}{\pub}}\rt)$.
 Since this is true for any $x\in\mymatrix{\qtemp\\
 Y^T}\lt(\lt(S\oplus \iztope{\pinv{\qtemp}}{\lb}{\ub}\rt)\bigcap\ptope{\qtemp}{\plb}{\pub}\rt)$,
 we proved Equation~\ref{eqn:intersection2}
\end{proof}
