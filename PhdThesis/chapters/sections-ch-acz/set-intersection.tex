We shall now introduce the augmented complex zonotope set
representation and describe the over-approximation of its intersection
with a sub-parallelotope.  In Lemma~\ref{lem:motivation}, we have shown that the
intersection of a suitably aligned interval zonotope with a
sub-parallelotope can be computed exactly by a simple algebraic
formula.  Motivated by this, we specify an augmented complex zonotope
as a Minkowski sum of a template complex zonotope and an interval
zonotope.  The idea behind such a representation is that the interval
zonotope part is used to compute the intersection with a
sub-parallelotope, while the template complex zonotope may capture
positive invariance based on complex eigenstructure.  We will
mathematically formalize this idea latter.
%
\begin{definition}
Let us consider a template complex zonotope
$\tcztope{\ptemp}{\cen}{\sfact}\subseteq\compnums^n$ and an interval
zonotope $\iztope{\stemp}{\lb}{\ub}\subseteq\reals^n$.  Then the
following is the representation of an augmented complex zonotope.
%
\[
\acztope{\ptemp}{\cen}{\sfact}{\stemp}{\lb}{\ub}=\minsum{\tcztope{\ptemp}{\cen}{\sfact}}{\iztope{\stemp}{\lb}{\ub}}.
\]
%
\end{definition}
%
In this section, we shall consider
%
\begin{align*}
& \lb,\ub\in\reals^k:
k<n,~~~\plb\in\set{\reals,-\infty}^n,~~~\pub\in\set{\reals,\infty}^n\\
& \ptemp\in\mat{n}{m}{\compnums},~~~\qtemp\in\mat{k}{n}{\reals}:~\lt(\qtemp\qtemp^T\rt)~\text{is
non-singular}\\
& \sfact\in\reals_{\geq 0}^m,~~\cen\in\compnums^n.      
\end{align*}
%
Recall that an augmented
complex zonotope is a Minkowski sum of a template complex zonotope and
an interval zonotope, i.e.,
%
\[
\acztope{\ptemp}{\cen}{\sfact}{\stemp}{\lb}{\ub}=\minsum{\tcztope{\ptemp}{\cen}{\sfact}}{\iztope{\stemp}{\lb}{\ub}}.
\]
%
According to Lemma~\ref{lem:motivation}, the intersection of a
sub-parallelotope $\ptope{\qtemp}{\plb}{\pub}$ with an interval
zonotope $\iztope{\stemp}{\lb}{\ub}$ can be computed by a simple
algebraic formula when $\stemp=\pinv{\qtemp}$.  To extend this, we
want to find a condition such that we can over-approximate the
intersection of an augmented complex zonotope and a sub-parallelotope
%
\begin{align*}
& \intersection{\acztope{\ptemp}{\cen}{\sfact}{\pinv{\qtemp}}{\lb}{\ub}}{\ptope{\qtemp}{\plb}{\pub}}\\
& =\intersection{\lt(\minsum{\tcztope{\ptemp}{\cen}{\sfact}}{\iztope{\pinv{\qtemp}}{\lb}{\ub}\rt)}}{\ptope{\qtemp}{\plb}{\pub}}
\end{align*}
%
by another augmented complex zonotope given as
%
\begin{align*}
& \minsum{\tcztope{\ptemp}{\cen}{\sfact}}{\intersection{\lt(\iztope{\pinv{\qtemp}}{\lb}{\ub}}{\ptope{\qtemp}{\plb}{\pub}\rt)}}\\
& =
  \minsum{\tcztope{\ptemp}{\cen}{\sfact}}{\iztope{\pinv{\qtemp}}{\join{\lb}{\plb}}{\meet{\ub}{\pub}}}\\
& = \acztope{\ptemp}{\cen}{\sfact}{\pinv{\qtemp}}{\join{\lb}{\plb}}{\meet{\ub}{\pub}},
\end{align*}
%
That is, we first compute the intersection of
sub-parallelotope with the interval zonotope (which can be done
efficiently) and then take the Minkowski sum with the template complex
zonotope.  We want to find a condition when the resultant augmented
complex zonotope is a valid over-approximation of the intersection.

For deriving the required condition, we use some well known properties
of support functions given below.
%
\begin{lemma}[See Exercise 3.35
in~\cite{todo}]~\label{lem:supp-calculus}.  Let $\Psi_1,\Psi_2\subseteq\reals^n$.  Then all of the following are true.
%
\begin{enumerate}
\item If $v\in\reals^n$, then $\supp{v}{\Psi_1\oplus\Psi_2}=\supp{v}{\Psi_1}+\supp{v}{\Psi_2}$.
\item Let $\Psi_2$ be a closed and convex set.  Then
$\Psi_1\subseteq\Psi_2$ iff
%
\[
\forall v\in\reals^n:~\supp{v}{\Psi_1}\leq\supp{v}{\Psi_2}
\]
%
\end{enumerate}
%
\end{lemma}
%
In the above Lemma, we see $\Psi_1$ is contained inside a closed and
convex set $\Psi_2$ iff the support function of $\Psi_1$ is less than
the support function of $\Psi_2$.  In this regard, for two closed and
convex sets $\Psi_1,\Psi_2$ such that $\Psi_1\subseteq\Psi_2$, we
intoduce thr following measure of approximation error in
over-approximating $\Psi_1$ by $\Psi_2$.
%
\begin{definition}[A measure of over-approximation]
For two closed and convex sets $\Psi_1,\Psi_2\subset\reals^n$, we
define
\[
\approxerror{\Psi_1}{\Psi_2}=\max_{w,v\in\reals^n:~\norm{w-v}\leq
  1}\lt(\support{w}{v}{\real\lt(\Psi_2\rt)}-\support{w}{v}{\real\lt(\Psi_1\rt)}\rt)
\]
%
\end{definition}
%
Based on Lemma~\ref{lem:supp-calculus}, for two closed and convex sets
real valued sets
$\Psi_1$ and $\Psi_2$, both the following equations are true.
%
\begin{align*}
& \Psi_1\subseteq\Psi_2 \equivalent \approxerror{\Psi_1}{\Psi_2}\leq 0\\
& \Psi_1=\Psi_2 \equivalent \approxerror{\Psi_1}{\Psi_2}=0.
\end{align*}
%
We also use the following property of support function.
%
\begin{lemma}~\label{lem:supp-mult-matrix}
For a matrix $A\in\mat{n}{n}{\reals}$, we get $\supp{Av}{\Psi}=\supp{v}{A^T\Psi}$.
\end{lemma}
%
\begin{proof}
$\supp{Av}{\Psi}=\max_{x\in\Psi}v^T\lt(A^Tx\rt)=\max_{x\in
A^T\Psi}v^Tx=\supp{v}{A^T\Psi}.$
\end{proof}
%
Let us denote the $i^{th}$ column vector of the identity matrix by
$\idvec{i}$, where $\lt(\idvec{i}\rt)_j=1$ if $i=j$ and $0$ otherwise.
Let us consider that $Y\in\mat{n}{n-k}{\reals}$ is a basis for
$\nullspace{\qtemp}$ when $k<n$.  If $k=n$ then $Y=0$.  For any
$\alpha\in\reals^n$, let us define $\ind{\alpha}\in\reals^n$ as
follows. 
%
\[
\forall i\in\set{1,...,n}:~\ind{\alpha}=
\lt\{\begin{array}{l}
0~~\text{if}~\supp{\alpha_i}{\lt(\plb_i,\pub_i\rt)}<\infty~\text{and}~i\leq k\\
1~~\text{otherwise}.
\end{array}
\right.
\]
%

The following lemma gives an expression for the support function of
the intersection of a sub-parallelotope an augmented complex zonotope.
In the lemma, we write a vector in terms of the basis
$\mymatrix{\transpose{\qtemp} & Y}$.  We denote
$\Psi_1=\acztope{\ptemp}{\cen}{\sfact}{\pinv{\qtemp}}{\plb}{\pub}$ and
$\Psi_2=\ptope{\pinv{\qtemp}}{\plb}{\pub}$.
%
\begin{lemma}[Support function of intersection]~\label{lem:supp-intersection}
Let $S\in\reals^n$ be a closed and convex set and
$\lb\leq\maxapprox{\lb}{\plb}\leq\minapprox{\ub}{\pub}\leq\ub$. Then,
%
\begin{align*}
& \mymatrix{\qtemp\\ Y^T}\lt(\lt(S\oplus \iztope{\pinv{\qtemp}}{\lb}{\ub}\rt)\bigcap\ptope{\qtemp}{\plb}{\pub}\rt)\\
&= \diagonal{\ind{\alpha}}\mymatrix{\qtemp\\ Y}S
 \oplus\iztope{\mymatrix{\qtemp\\ Y^T}\pinv{\qtemp}}{\maxapprox{\lb}{\plb}}{\minapprox{\ub}{\pub}}.
\end{align*}
%
\end{lemma}
%
\begin{lemma}[Support function of intersection]~\label{lem:supp-intersection}
Let us consider a vector $v\in\reals^n$. Since $\mymatrix{\qtemp^T &
Y}$ is a basis of $\reals^n$, there exists $\alpha\in\reals^n$ such
that $v=\mymatrix{\qtemp^T & Y}\alpha$.  Let
$\lb\leq\maxapprox{\lb}{\plb}\leq\minapprox{\ub}{\pub}\leq\ub$. Then,
%
\begin{align*}
& \supp{v}{\Psi_1\bigcap\Psi_2}=\\
& \supp{\alpha}{\diagonal{\ind{\alpha}}}{\tcztope{\mymatrix{\qtemp\\
Y^T}\ptemp}{\cen}{\sfact}}
 +\supp{v}{\iztope{\pinv{\qtemp}}{\maxapprox{\lb}{\plb}}{\minapprox{\ub}{\pub}}}.
\end{align*}
%
\end{lemma}
%
\begin{proof}
We get $\supp{\mymatrix{\qtemp^T & Y}\alpha}{\Psi_1\bigcap\Psi_2}\leq$
%
\begin{align}
& \lt(\supp{\mymatrix{\qtemp^T &
Y}\diagonal{\ind{\alpha}}\alpha}{\Psi_1\bigcap\Psi_2}\right.\nonumber\\
& \left.+\supp{\mymatrix{\qtemp^T
& Y}\lt(\alpha-\diagonal{\ind{\alpha}}\alpha\rt)}{\Psi_1\bigcap\Psi_2}\right)\nonumber\\
& \leq \supp{\mymatrix{\qtemp^T &
Y}\diagonal{\ind{\alpha}}\alpha}{\Psi_1}
+\supp{\mymatrix{\qtemp^T &
Y}\lt(\alpha-\diagonal{\ind{\alpha}}\rt)}{\Psi_2}\nonumber\\
& \%\%~~\text{By Lemma~\ref{lem:supp-mult-matrix}}\nonumber\\
& = \supp{\diagonal{\ind{\alpha}}\alpha}{\mymatrix{\qtemp \\
Y^T}\Psi_1}
+\supp{\lt(\alpha-\diagonal{\ind{\alpha}}\alpha\rt)}{\mymatrix{\qtemp \\
Y^T}\Psi_2}\nonumber\\
& \%\%~~\text{since}~~\forall i>k:\lt(\ind{\alpha}\rt)_i=1\nonumber\\
& = \supp{\diagonal{\ind{\alpha}}\alpha}{\mymatrix{\qtemp \\
Y^T}\Psi_1}
+\supp{\lt(\alpha-\diagonal{\ind{\alpha}}\alpha\rt)}{\mymatrix{\qtemp \\
0}\Psi_2}.~\label{proof-supp1}\\
& \supp{\lt(\alpha-\diagonal{\ind{\alpha}}\alpha\rt)}{\mymatrix{\qtemp \\
0}\Psi_2}=\supp{\lt(\alpha-\diagonal{\ind{\alpha}}\alpha\rt)}{\mymatrix{\qtemp \\
0}\ptope{\qtemp}{\plb}{\pub}}\nonumber\\
& \%\%~~\text{By Lemma~\ref{lem:ptope-iz-conversion}}\nonumber\\
& = \supp{\lt(\alpha-\diagonal{\ind{\alpha}}\alpha\rt)}{\mymatrix{\qtemp \\
0}\lt(\nullspace{\qtemp}\oplus \set{\pinv{\qtemp}\zeta:~\zeta\in\reals^k,~\plb\leq\zeta\leq\pub}\rt)}\nonumber\\
& = \supp{\lt(\alpha-\diagonal{\ind{\alpha}}\alpha\rt)}{\set{\zeta\in\reals^k:\plb\leq\zeta\leq\pub}}\nonumber\\
& = \sum_{i=1}^n\supp{\lt(1-\ind{\alpha}_i\rt)\alpha_i}{\lt(\plb_i,\pub_i\rt)}\nonumber\\
& \%\%~~\text{since}~\lt(\ind{\alpha}\rt)_i=0~\text{iff}~\supp{\alpha_i}{\lt(\plb_i,\pub_i\rt)}<\infty
~\text{and}~i\leq k\nonumber\\
& = \sum_{i:\lt(\ind{\alpha}\rt)_i=0}\supp{\alpha_i}{\lt(\plb_i,\pub_i\rt)}.
\end{align}
%
When $\supp{\alpha_i}{\lt(\plb_i,\pub_i\rt)}<\infty$, we have the
following three cases.

Case 1: $\alpha_i< 0$.  Then
$\supp{\alpha_i}{\lt(\plb_i,\pub_i\rt)}=\alpha_i\plb_i<\infty$.  So,
$\plb_i>-\infty$ which implies $\plb_i=\lt(\maxapprox{\lb}{\plb}\rt)_i$.
Since, $\maxapprox{\lb}{\plb}\leq\minapprox{\ub}{\pub}$ as given, we
get
$\supp{\alpha_i}{\lt(\lt(\maxapprox{\lb}{\plb}\rt)_i,\lt(\minapprox{\ub}{\pub}\pub\rt)_i\rt)}
=\alpha_i\lt(\maxapprox{\lb}{\plb}\rt)_i
=\alpha_i\plb_i=\supp{\alpha_i}{\lt(\plb_i,\pub_i\rt)}$.

Case 2: $\alpha_i> 0$.  Then
$\supp{\alpha_i}{\lt(\plb_i,\pub_i\rt)}=\alpha_i\pub_i<\infty$.  So,
$\pub_i<\infty$ which implies $\pub_i=\lt(\minapprox{\ub}{\pub}\rt)_i$.
Since, $\maxapprox{\lb}{\plb}\leq\minapprox{\ub}{\pub}$ as given, we
get
$\supp{\alpha_i}{\lt(\lt(\maxapprox{\lb}{\plb}\rt)_i,\lt(\minapprox{\ub}{\pub}\pub\rt)_i\rt)}=
\alpha_i\lt(\minapprox{\ub}{\pub}\rt)_i
=\alpha_i\pub_i=\supp{\alpha_i}{\lt(\plb_i,\pub_i\rt)}$.

Case 3: $\alpha_i=0$.  Then
$0=\supp{\alpha_i}{\lt(\plb_i,\pub_i\rt)}=\supp{0}{\lt(\plb_i,\pub_i\rt)}$\\
$=
\supp{0}{\lt(\lt(\maxapprox{\lb}{\plb}\rt)_i,\lt(\minapprox{\ub}{\pub}\pub\rt)_i\rt)}
= \supp{\alpha_i}{\lt(\lt(\maxapprox{\lb}{\plb}\rt)_i,\lt(\minapprox{\ub}{\pub}\pub\rt)_i\rt)}$.

So, we get
%
\begin{align}
& \supp{\lt(\alpha-\diagonal{\ind{\alpha}}\alpha\rt)}{\mymatrix{\qtemp \\
0}\Psi_2}\nonumber\\
& =\sum_{i:1\leq i\leq
k\lt(\ind{\alpha}\rt)_i=0}\supp{\alpha_i}{\lt(\lt(\maxapprox{\lb}{\plb}\rt)_i,\lt(\minapprox{\ub}{\pub}\pub\rt)_i\rt)}.~\label{proof-supp3}\\
& \supp{\diagonal{\ind{\alpha}}\alpha}{\mymatrix{\qtemp \\
Y^T}\Psi_1}\nonumber\\
& =\supp{\diagonal{\ind{\alpha}}\alpha}{\mymatrix{\qtemp \\
Y^T}\lt(\tcztope{\ptemp}{\cen}{\sfact}\oplus\iztope{\pinv{\qtemp}}{\lb}{\ub}\rt)}\nonumber\\
& =\supp{\diagonal{\ind{\alpha}}\alpha}{\mymatrix{\qtemp \\
Y^T}\tcztope{\ptemp}{\cen}{\sfact}}+\supp{\diagonal{\ind{\alpha}}\alpha}{\mymatrix{\qtemp \\
Y^T}\iztope{\pinv{\qtemp}}{\lb}{\ub}}.~\label{proof-supp4}\\
& \supp{\diagonal{\ind{\alpha}}\alpha}{\mymatrix{\qtemp \\
Y^T}\iztope{\pinv{\qtemp}}{\lb}{\ub}}\nonumber\\
& = \supp{\diagonal{\ind{\alpha}}\alpha}{\mymatrix{\qtemp \\
Y^T}\set{\pinv{\qtemp} \zeta:~\zeta in\reals^n:\lb\leq \zeta\leq\ub}}\nonumber\\
& = \supp{\diagonal{\ind{\alpha}}\alpha}{\set{x\in\reals^n:~\forall i:
1\leq i\leq k,~\lb_i\leq \ub_i,~\forall i>k,x_i=0}}\nonumber\\
&
= \sum_{i=1}^k\supp{\ind{\alpha}_i\alpha_i}{\lt(\lb_i,\ub_i\rt)}.~\label{proof-supp5}
\end{align}
%
\begin{align}
todo
\end{align}
%
\end{proof}
%




























