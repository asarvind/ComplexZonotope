In the previous chapter, we described a set representation called
simple zonotope, which is a type of polytope represented as a linear
combination of real valued vectors with bounded combining
coefficients.  The advantage of simple zonotopes in set based
computations is that they are closed under matrix multiplication and
Minkowski sum operations and these can be computed efficiently.
However, for computing a positive invariant of a linear system, there
is no known procedure to choose a suitable set of generators for a
simple zonotope so as to compute an invariant.  In this chapter, we
extend simple zonotope a new set representation called \emph{complex
zonotope} by which we can easily specify invariants of a linear system
using the eigenstructure of the system.  Complex zonotopes have
complex valued generators complex combining coefficients bounded in
their absolute values, as opposed to the real valued generators and
real combining coefficients of simple zonotopes.  The real projections
of complex zonotopes can describe some non-polytopic sets in addition
to the polytopic zonotopes, which are Minkowski sums of some
ellipsoids along with line segments.  Furthermore, complex zonotopes
are also closed under matrix multiplications and Minkowski sums and
these can be computed efficiently.

Apart from discussing operations on complex zonotopes like linear
transformations and Minkowski sums, in this chapter we derive a convex
program for checking inclusion between two complex zonotopes.  The
inclusion relation is a key ingredient for efficient invariant
computation, as we shall see in the latter chapters.  The organization
of this chapter is as follows.  PUT ORGANIZATION.

\section{Representation of a complex zonotope}
\input{chapters/sections-ch-tcz/representation}

\section{Operations on a template complex zonotope}
\input{chapters/sections-ch-tcz/operations}

\section{Checking inclusion}
While computing positive invariants using a set representation,
ascertaining the positive invariance of a set requires deciding the
inclusion of the next reachable set inside the given set.  In the case
of complex zonotopes, we shall show that checking the exact inclusion
amounts to solving a is a non-convex optimization problem.  However,
we shall later propose a convex relaxation, which is a sufficient
condition for checking the inclusion.  Specifically, we shall express
derive a sufficient covex condition for inclusion checking expressed
as a set of second-order conic constraints on some variables, where a
second order conic constraint is defined as follows.
%
\begin{definition}[Second order conic constraint]
A second order conic constraint on a variable $x$ taking values in
$\reals^n$ is one of the following expressions.
\begin{enumerate}
\item  $\sqnorm{a^Tx+b}\leq c^Tx+d$ where $a,c\in\reals^n$ and
$b,d\in\reals$ are constants.
\item $p^Tx=q$ where $p\in\reals^n$ and $q\in\reals$ are constants.
\end{enumerate}
\end{definition}
%
Given a set of second order conic constraints on a variable
$x\in\reals^n$, solving the constraints refers to finding a value
$x^*\in\reals^n$ that satisfies the constraints.  A value
$x^\pr\in\reals^n$ is called an approximate solution within a
precision $\epsilon\in\reals_{\geq 0}$ if there exists a solution
$x^*\in\reals^n$ such that $\sqnorm{x^\pr-x^*}\leq \epsilon$.  There
are numerical algorithms based on interior point methods~\cite{todo}
that can efficiently find approximate solutions with very high
precision to second order conic constraints (SOCC).

Before deriving the non-convex condition for checking inclusion
between template complex zonotopes, we need to look at the inclusion
of a point inside a template complex zonotope, which is however
expressed as a set of convex constraints.
%
\begin{lemma}[Inclusion of a point]
Let us consider a template complex zonotope
$\tcztope{\ptemp}{\cen}{\sfact}\subset\compnums^n$ where
$\ptemp\in\mat{n}{m}{\compnums}$ and a point $x\in\compnums^n$.  Then
$x\in\tcztope{\ptemp}{\cen}{\sfact}\subset\compnums^n$ if and only if
all of the following is collectively true.
%
\begin{align}
& \exists\zeta\in\compnums^m:\nonumber\\
& \ptemp\zeta = x-c~\label{eqn:lem-point-inclusion-1}\\
& \absolute{\zeta}\leq \sfact.~\label{eqn:lem-point-inclusion-2}
\end{align}
%
\end{lemma}
%
\begin{proof}
The above result follows from the fact that any point 
$x\in\tcztope{\ptemp}{\cen}{\sfact}$ is of the form
$x=\cen+\ptemp\zeta$ for some $\zeta\in\compnums^m$ such that
$\absolute{\zeta}\leq \sfact$.
\end{proof}
%
Equation~\ref{eqn:lem-point-inclusion-1} is an equality constraint on
$\zeta$, which is therefore an SOCC.  We know that the absolute value
of a complex number is the square norm of a two dimensional vector.
So, Equation~\ref{eqn:lem-point-inclusion-2} is equivalent to a set of
square norm constraints on the real and imaginary components of
$\zeta$, which are therefore SOCC constraints.  Hence, the inclusion
of a point inside a template complex zonotope can be checked by
solving second order conic constraints.
%
\begin{lemma}[Exact inclusion between template complex zonotopes]~\label{lem:exact-inclusion}
Let us consider two template complex zonotopes
$\tcztope{\ptemp}{\cen}{\sfact},
\tcztope{\ptemp^\pr}{\cen^\pr}{\sfact^\pr}\subseteq\compnums^n$ such
that $\ptemp\in\mat{n}{m}{\compnums}$ and
$\ptemp^\pr\in\mat{n}{r}{\compnums}$.  The inclusion
$\tcztope{\ptemp^\pr}{\cen^\pr}{\sfact^\pr}\subseteq\tcztope{\ptemp}{\cen}{\sfact}$
holds if and only if
\begin{equation}\label{eqn:exact-inclusion}
\max_{\set{\zeta^\pr\in\compnums^{r}:\absolute{\zeta^\pr}\leq \sfact^\pr}}\min_{\set{\zeta\in\compnums^m:\ptemp\zeta=\ptemp^\pr\zeta^\pr+\cen^\pr-\cen}}\max_{i=1}^m\lt(\absolute{\zeta_i}-s_i\rt)\leq 0
\end{equation}
\end{lemma}
%
\begin{proof}
We have
$\tcztope{\ptemp^\pr}{\cen^\pr}{\sfact^\pr}\subseteq\tcztope{\ptemp}{\cen}{\sfact}$
iff for every $\zeta^\pr\in\compnums^r:\absolute{\zeta^\pr}\leq \sfact^\pr$,
there exists
$\zeta\in\compnums^m:\ptemp\zeta+\cen=\ptemp^\pr\zeta^\pr+\cen^\pr~\wedge~\absolute{\zeta}\leq
\sfact$.  This is equivalently expressed as the constraint
as \[\max_{\set{\zeta^\pr\in\compnums^{r}:\absolute{\zeta^\pr}\leq \sfact^\pr}}\min_{\set{\zeta\in\compnums^m:\ptemp\zeta=\ptemp^\pr\zeta^\pr+\cen-\cen^\pr}}\max_{i=1}^m\lt(\absolute{\zeta_i}-s_i\rt)\leq
0.\text{\hspace{5em}\qedhere}\]
\end{proof}
%
We shall now explain how solving Equation~\ref{eqn:exact-inclusion}
amounts to solving a non-covex optimization problem.  Let us consider
that $\ptemp$ has a pseudo-inverse $\pinv{\ptemp}$.  Then any solution
for $\zeta$ satisfying $\ptemp\zeta=\ptemp\zeta^\pr+\cen^\pr-\cen$ can
be written as $\pinv{\ptemp}\lt(\zeta^\pr-c\rt)+v$ where $v$ belongs
to the complex valued null-space of $\ptemp$.  Let us denote the
null-space of $\ptemp$ as $\nullspace{\ptemp}$.  So,
%
\begin{align*}
& \min_{\set{\zeta\in\compnums:\ptemp\zeta=\ptemp^\pr\zeta^\pr+\cen^\pr-\cen}}\max_{i=1}^m\lt(\absolute{\zeta_i}-s_i\rt)\\
&
=\min_{\set{v\in\nullspace{\ptemp}}}\max_{i=1}^m\lt(\absolute{\pinv{\ptemp}\lt(\zeta^\pr-c\rt)+v}-s_i\rt)
\end{align*}
%
The absolute value of a complex variable is a convex quadratic
function of the real and imaginary components of the variable.  So,
the above function is a point-wise minimum (for points $v$ in the null
space $\null{\ptemp}$) of a set of convex quadratic functions over
$\zeta^\pr$, which is therefore not a concave function of $\zeta^\pr$.
So the maximization
%
\[
\max_{\set{\zeta^\pr\in\compnums^{r}:\absolute{\zeta^\pr}\leq \sfact^\pr}}\min_{\set{\zeta\in\compnums^m:\ptemp\zeta=\ptemp^\pr\zeta^\pr+\cen^\pr-\cen}}\max_{i=1}^m\lt(\absolute{\zeta_i}-s_i\rt)
\]
%
is equivalent to maximizing a non-concave function of $\zeta^\pr$.
Maximizing a non-concave function is a non-covex optimization problem.

However, we will derive a sufficient condition expressed as a set of
convex constraints on the center and scaling factors and some
additional variables, which would be sufficient to guarantee inclusion
between two complex zonotopes.  More precisely, we derive a class of
convex constraints called second order conic constraints that can be
solved efficiently using interior point methods~\cite{todo}.  We shall
first explain second order conic constraints before deriving
the convex condition for inclusion checking.


Now we shall discuss the derivation of the set of convex constraints
as sufficient condition for inclusion-checking between two
complex-zonotopes.
%
\begin{lemma}~\label{lem:transfer-matrix}
  Let $\sfact\in\reals^m_{\geq 0}$, $\sfact^\pr\in\reals^r_{\geq 0}$
  and $\zeta^\pr\in\compnums^r$ such that
  $\absolute{\zeta^\pr}\leq\sfact^\pr$ and
  $\cen,\cen^\pr\in\compnums^n$.  Let $\ptemp\in\mat{n}{m}{\compnums}$
  and $\ptemp^\pr\in\mat{n}{r}{\compnums}$ such that $\ptemp\tmat=\ptemp^\pr\diagonal{\sfact^\pr}$ and
  $\ptemp\tvect=\lt(c^\pr-c\rt)$ for a complex matrix $X$ and a
  complex vector $y$.  Then,
  %
\begin{equation}\label{eqn:transfer-matrix}
\min_{\set{\zeta\in\compnums:\ptemp\zeta=\ptemp^\pr\zeta^\pr+\cen^\pr-\cen}}\max_{i=1}^m\lt(\absolute{\zeta_i}-\sfact_i\rt)\leq \max_{i=1}^m\lt(\absolute{\tvect_i}+\sum_{j=1}^r\absolute{\tmat_{ij}}-\sfact_i\rt).
\end{equation}
%
\end{lemma}
%
\begin{proof}
Consider $\epsilon\in\compnums^{r}$, where for any $i\in\set{1,...,r}$,
%
$\left\{
\begin{array}{l}
\epsilon_i=\frac{\zeta^\pr}{s^\pr_i}~\text{if}~ s^\pr_i\neq 0\\
\epsilon_i=0~\text{otherwise}
\end{array}
\right.$.
%
Since $\absolute{\zeta^\pr}\leq s^\pr$ as given, so
we have $\zeta^\pr=\diagonal{s^\pr}\epsilon$ and
$\max_{j=1}^r\absolute{\epsilon_j}\leq 1$.  By
using the relations given in the lemma, we henceforth get
%
\begin{align*}
&\ptemp^\pr\zeta^\pr+c-c^\pr
=\ptemp^\pr\diagonal{\sfact^\pr}\epsilon+c-c^\pr
=\ptemp\tmat\epsilon+\ptemp\tvect
=\ptemp\lt(\tmat\epsilon+\tvect\rt)
\end{align*}
%
Therefore,
%
\begin{align*}
& \min_{\set{\zeta\in\compnums:\ptemp\zeta=\ptemp^\pr\zeta^\pr+\cen^\pr-\cen}}\max_{i=1}^m\lt(\absolute{\zeta_i}-\sfact_i\rt)\leq \max_{i=1}^m\lt(\absolute{\lt(X\epsilon+y\rt)_i}-\sfact_i\rt)\\
&\leq \max_{i=1}^m\lt(\absolute{\tvect_i}+\sum_{j=1}^r\absolute{\tmat_{ij}}\absolute{\epsilon_j}-\sfact_i\rt)
~~\%\%~\text{Using triangular inequality}\\
& \leq  \max_{i=1}^m\lt(\absolute{\tvect_i}+\sum_{j=1}^r\absolute{\tmat_{ij}}-\sfact_i\rt)
~~\%\%~\text{Since}~\max_{j=1}^r\absolute{\epsilon_j}\leq 1.
\end{align*}
%
\end{proof}
%
Based on the above lemma, we define a relation between two template
complex zonotopes, which is a sufficient condition for the inclusion
relation.
%
\begin{definition}[Relation for inclusion-checking]~\label{defn:inclusion-tcz}
For two template complex zonotopes $\tcztope{\ptemp}{\cen}{\sfact}$
and $\tcztope{\ptemp^\pr}{\cen^\pr}{\sfact^\pr}$ such that
$\ptemp\in\mat{n}{m}{\compnums}$ and
$\ptemp^\pr\in\mat{n}{r}{\compnums}$, we say
$\tcztope{\ptemp}{\cen}{\sfact}\order\tcztope{\ptemp^\pr}{\cen^\pr}{\sfact^\pr}$
if all of the following are collectively true.
%
\begin{align*}
& \exists \tmat\in\mat{m}{r}{\compnums},\tvect\in\compnums^m~~\text{such
that}\\
& \ptemp\tmat=\ptemp^\pr\diagonal{\sfact^\pr},~~\ptemp\tvect=\cen^\pr-\cen\\
& \max_{i=1}^m\lt(\absolute{\tvect_i}+\sum_{j=1}^r\absolute{\tmat_{ij}}-\sfact_i\rt)\leq
0.
\end{align*}
%
\end{definition}
%
\begin{theorem}[Sufficient condition for inclusion checking]~\label{thm:suff-inclusion}
The inclusion\\
$\tcztope{\ptemp}{\cen}{\sfact}\subseteq\tcztope{\ptemp^\pr}{\cen^\pr}{\sfact^\pr}$
holds if the relation
$\tcztope{\ptemp}{\cen}{\sfact}\order\tcztope{\ptemp^\pr}{\cen^\pr}{\sfact^\pr}$
is true.
\end{theorem}
%
\begin{proof}
We have shown in Lemma~\ref{lem:exact-inclusion} that the inclusion
$\tcztope{\ptemp}{\cen}{\sfact}\subseteq\tcztope{\ptemp^\pr}{\cen^\pr}{\sfact^\pr}$
holds iff the L.H.S of Equation~\ref{eqn:exact-inclusion} is bounded
above by zero.  Based on Lemma~\ref{lem:transfer-matrix}, the R.H.S of
Equation~\ref{eqn:transfer-matrix} is an upper bound on the L.H.S of
Equation~\ref{eqn:exact-inclusion}.  So, if
$\tcztope{\ptemp}{\cen}{\sfact}\order\tcztope{\ptemp^\pr}{\cen^\pr}{\sfact^\pr}$,
then the R.H.S of Equation~\ref{eqn:transfer-matrix} would be
bounded above by zero and the condition for inclusion in
Equation~\ref{eqn:exact-inclusion} would be satisfied.
\end{proof}
%
%% Furthermore, the above relation is a partial order.
%
%% \begin{theorem}[Paritial ordering]
%% The relation ``$\order$'' between template complex zonotopes is a
%% partial order.  That is, for any three template complex zonotopes
%% $\tcz{\ptemp}{\cen}{\sfact}$, $\tcz{\ptemp^\pr}{\cen^\pr}{\sfact^\pr}$
%% and $\tcz{\ptemp^\dpr}{\cen^\dpr}{\sfact^\dpr}$, all of the following
%% conditions are true.
%% %
%% \begin{enumerate}
%% \item Reflexivity:
%% $\tcz{\ptemp}{\cen}{\sfact}\order\tcz{\ptemp}{\cen}{\sfact}$.
%% \item Antisymmetry: If
%% $\tcz{\ptemp}{\cen}{\sfact}\order\tcz{\ptemp^\pr}{\cen^\pr}{\sfact^\pr}$
%% and
%% $\tcz{\ptemp^\pr}{\cen^\pr}{\sfact^\pr}\order\tcz{\ptemp}{\cen}{\sfact}$,
%% then
%% $\tcz{\ptemp}{\cen}{\sfact}=\tcz{\ptemp^\pr}{\cen^\pr}{\sfact^\pr}$.
%% \item Transitivity: If
%% $\tcz{\ptemp^\pr}{\cen^\pr}{\sfact^\pr}\order\tcz{\ptemp}{\cen}{\sfact}$
%% and
%% $\tcz{\ptemp^\dpr}{\cen^\dpr}{\sfact^\dpr}\order\tcz{\ptemp^\pr}{\cen^\pr}{\sfact^\pr}$,
%% then $\tcz{\ptemp^\dpr}{\cen^\dpr}{\sfact^\dpr}\order\tcz{\ptemp}{\cen}{\sfact}$.
%% \end{enumerate}
%% %
%% \end{theorem}
%% %
%% \begin{proof}
%% \begin{enumerate}
%% \item {\it Reflexivity}:  Consider $\tmat=\diagonal{\sfact}$ and
%% $\tvect=\repmat{m}{1}$.  Then, 
%% $\ptemp\tmat=\ptemp\diagonal{\sfact}$,
%% $\ptemp\tvect=0=c-c$ and
%% %
%% \vspace{-1em}
%% \begin{align*}
%% & \max_{i=1}^m\lt(\absolute{y_i}+\sum_{j=1}^m\absolute{X_{ij}}-\sfact_i\rt)
%% =\max_{i=1}^m\lt(0+\sfact_i-\sfact_i\rt)=0\\
%% \end{align*}
%% %
%% So, $\tcz{\ptemp}{\cen}{\sfact}\order\tcz{\ptemp}{\cen}{\sfact}$.
%% \item {\it Antisymmetry}: Let
%% $\tcz{\ptemp}{\cen}{\sfact}\order\tcz{\ptemp^\pr}{\cen^\pr}{\sfact^\pr}$
%% and
%% $\tcz{\ptemp^\pr}{\cen^\pr}{\sfact^\pr}\order\tcz{\ptemp}{\cen}{\sfact}$.
%% By Theorem~\ref{thm:suff-inclusion}, this implies
%% $\tcz{\ptemp}{\cen}{\sfact}\subseteq\tcz{\ptemp^\pr}{\cen^\pr}{\sfact^\pr}$
%% and
%% $\tcz{\ptemp^\pr}{\cen^\pr}{\sfact^\pr}\subseteq\tcz{\ptemp}{\cen}{\sfact}$.
%% So,
%% $\tcz{\ptemp}{\cen}{\sfact}=\tcz{\ptemp^\pr}{\cen^\pr}{\sfact^\pr}$.
%% %
%% \item Consider that $\ptemp\in\mat{n}{m}{\compnums}$,
%% $\ptemp^\pr\in\mat{n}{r}{\compnums}$,
%% $\ptemp^\dpr\in\mat{n}{k}{\compnums}$ and the orderings
%% $\tcz{\ptemp}{\cen}{\sfact}\order\tcz{\ptemp^\pr}{\cen^\pr}{\sfact^\pr}$
%% and
%% $\tcz{\ptemp^\pr}{\cen^\pr}{\sfact^\pr}\order\tcz{\ptemp^\dpr}{\cen^\dpr}{\sfact^\dpr}$.
%% This implies,
%% %
%% \begin{align*}
%% & \exists \tmat\in\mat{m}{r}{\compnums},\tvect\in\compnums^m~~\text{such
%% that}\\
%% & \ptemp\tmat=\ptemp^\pr\diagonal{\sfact^\pr},~~\ptemp\tvect=\cen^\pr-\cen,\\
%% & \max_{i=1}^m\lt(\absolute{\tvect_i}+\sum_{j=1}^r\absolute{\tmat_{ij}}-\sfact_i\rt)\leq
%% 0
%% \end{align*}
%% %
%% and
%% \begin{align*}
%% & \exists \tmat^\pr\in\mat{m}{k}{\compnums},\tvect^\pr\in\compnums^m~~\text{such
%% that}\\
%% & \ptemp^\pr\tmat^\pr=\ptemp^\dpr\diagonal{\sfact^\dpr},~~\ptemp\tvect^\pr=\cen^\dpr-\cen^\pr,\\
%% & \max_{i=1}^m\lt(\absolute{\tvect^\pr_i}+\sum_{j=1}^k\absolute{\tmat^\pr_{ij}}-\sfact_i^\pr\rt)\leq
%% 0.
%% \end{align*}
%% %
%% Let $\tmat^\dpr=\tmat\tmat^\pr$ and $\tvect^\dpr=\tvect+\tvect^\pr$.
%% Then
%% \[
%% \ptemp\tmat^\dpr=\ptemp\tmat\tmat^\pr=
%% \]
%% \end{enumerate}
%% \end{proof}
%
If we consider the scaling factors and the center as variables, then
the above sufficient condition for inclusion-checking can be
efficiently reformulated as a set of second-order conic constraints on
the center, scaling factors and some auxillary variables.  This is
explained in the following proposition.
%
\begin{proposition}
If
$\cen,\cen^\pr\in\compnums^n,\sfact\in\reals^m,\sfact^\pr\in\reals^k$
are variables and\\
$\ptemp\in\mat{n}{m}{\compnums},\ptemp^\pr\in\mat{n}{k}{\compnums}$
are constants, the relation between template complex zonotopes
$\tcztope{\ptemp}{\cen}{\sfact}\order\tcztope{\ptemp^\pr}{\cen^\pr}{\sfact^\pr}$
can be expressed as a collection of $\lt(nk+n+m\rt)$ second order
conic constraints on a vector variable of size \\$\lt(mk+2n+2m+k\rt)$
comprising components of $\sfact,\sfact^\pr,\cen,\cen^\pr$ and some
additional variables.
\end{proposition}
%
\begin{proof}
{\color{red} TODO}
\end{proof}
%
Although the above relation is a sufficient condition for
inclusion-checking, it is also a necessary condition when the template
of the complex zonotope within which the containment is checked is
invertible.  This is explained in the following theorem.
%
\begin{theorem}
Let
$\tcztope{\ptemp}{\cen}{\sfact},\tcztope{\ptemp^\pr}{\cen^\pr}{\sfact^\pr}\subseteq\compnums^n$
be two complex zonotopes such that $\ptemp\in\mat{n}{n}{\compnums}$ is
an invertible square matrix.  Then
$\tcztope{\ptemp^\pr}{\cen^\pr}{\sfact^\pr}\subseteq\tcztope{\ptemp}{\cen}{\sfact}$
if and only if $\tcztope{\ptemp^\pr}{\cen^\pr}{\sfact^\pr}\order\tcztope{\ptemp}{\cen}{\sfact}$.
\end{theorem}
%
\begin{proof}
By Theorem~\ref{thm:suff-inclusion}, we know that if
$\tcztope{\ptemp^\pr}{\cen^\pr}{\sfact^\pr}\order\tcztope{\ptemp}{\cen}{\sfact}$
is true,
then
$\tcztope{\ptemp^\pr}{\cen^\pr}{\sfact^\pr}\subseteq\tcztope{\ptemp}{\cen}{\sfact}$.
So, we are left to prove that if
$\tcztope{\ptemp^\pr}{\cen^\pr}{\sfact^\pr}\subseteq\tcztope{\ptemp}{\cen}{\sfact}$,
then
$\tcztope{\ptemp^\pr}{\cen^\pr}{\sfact^\pr}\order\tcztope{\ptemp}{\cen}{\sfact}$.

Let us consider
$\tcztope{\ptemp^\pr}{\cen^\pr}{\sfact^\pr}\subseteq\tcztope{\ptemp}{\cen}{\sfact}$.
Let $y=\inv{\ptemp}\lt(\cen^\pr-\cen\rt)$ and
$X=\inv{\ptemp}\ptemp^\pr\diagonal{\sfact^\pr}$.  
According
to Lemma~\ref{lem:normalization},
$\tcztope{\ptemp^\pr}{\cen^\pr}{\sfact^\pr}=\cztope{\ptemp^\pr\diagonal{\sfact^\pr}}{\cen^\pr}$.
Let us consider a point
$x\in\cztope{\ptemp^\pr\diagonal{\sfact^\pr}}{\cen^\pr}$ described as the
linear combination of generators as
$x=\cen^\pr+\ptemp^\pr\diagonal{\sfact^\pr}\zeta^\pr$ where
$\infnorm{\zeta^\pr}\leq 1$.  As $\ptemp$ is invertible, so $x$ can be
written uniquely by linear combination of column vector of $\ptemp$
plus the center $\cen$ as 
%
\begin{align*}
&
x=\cen+\ptemp\lt(\inv{\ptemp}(x-c)\rt)\\
&
= \cen+\ptemp\inv{\ptemp}\lt(\cen^\pr+\ptemp^\pr\diagonal{\sfact^\pr}\zeta^\pr-\cen\rt)\\
& = \cen+\ptemp\lt(y+X\zeta^\pr\rt)
\end{align*}
%
where the vector of combining coefficients is
%
\[
y+X\zeta^\pr.
\]
%
As
%
\[
\cztope{\ptemp^\pr\diagonal{\sfact^\pr}}{\cen^\pr}=\tcztope{\ptemp^\pr}{\cen^\pr}{\sfact^\pr}\subseteq\tcztope{\ptemp}{\cen}{\sfact},
\]
%
we get that for all
$\zeta^\pr\in\compnums^n:\infnorm{\zeta^\pr}\leq 1$ and $\forall i\in\set{1,...,n}$,
%
\[
\absolute{y_i}+\sum_{j=1}^n\absolute{X_{ij}\zeta^\pr_j}=\absolute{y_i}+\sum_{j=1}^n\absolute{X_{ij}}\absolute{\zeta^\pr_j}\leq s_i.
\]
%
As the above is true for all
$\zeta^\pr\in\compnums^n:\infnorm{\zeta^\pr}\leq 1$, so by substituting
$\zeta^\pr_j=1$  we get that for all $i\in\set{1,...,n}$,
%
\[
\absolute{y_i}+\sum_{j=1}^n\absolute{X_{ij}}-s_i.
\]
%
Furthermore,
%
\[
\ptemp y= \ptemp\inv{\ptemp}\lt(\cen^\pr-\cen\rt) = \cen^\pr-\cen
\]
%
and
\[
\ptemp X=\ptemp\inv{\ptemp}\ptemp^\pr\diagonal{\sfact^\pr}=\ptemp^\pr\diagonal{\sfact^\pr}.
\]
%
Therefore, $\tcztope{\ptemp^\pr}{\cen^\pr}{\sfact^\pr}\order\tcztope{\ptemp}{\cen}{\sfact}$.
\end{proof}

\section{Reachable set computation for linear systems}

Similar to simple zonotopes, template complex zonotopes can also
efficiently represent the bounded time reachable set of a discrete
time linear system
%
\begin{align*}
\trj{x}{t+1}=A\trj{x}{t}+ \inptrj{t}\\
\trj{x}{0}\in\init~,\forall t\in\integers_{\geq 0}~\trj{t}\in\inputset
\end{align*}
%
due to its closure under linear transformation and Minkowski sum
operations and efficient computations of the same.  Based on
Lemmas~\ref{lem:lin-transform}
and~\ref{lem:min-sum}, if the initial set is
$\init=\tcztope{\inittemp}{\initcen}{\initsfact}$ and the input set is
$\inputset=\tcztope{\inputtemp}{\inputcen}{\inputsfact}$, then the
reachable set at a time point is computed as
%
\begin{align}
& \reachset{t}=\tcztope
{% template
\minsum{A^t\inittemp}{\lt(\sum_{i=0}^{t-1}A^i\rt)\inputtemp}
}
{% center
A^t\initcen+\lt(\sum_{i=0}^{t-1}A^i\rt)\inputcen
}
{% scaling factors
\lt[\begin{matrix}
\initsfact \\
\inputsfact
\end{matrix}
\rt]
}.
\end{align}

