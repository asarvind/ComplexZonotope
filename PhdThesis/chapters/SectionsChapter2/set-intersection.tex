\section{Augmented Complex Zonotope and Intersection with Sub-parallelotope}
We shall now introduce the augmented complex zonotope set
representation and describe the over-approximation of its intersection
with a sub-parallelotope.  In Lemma~\ref{}, we have shown that the
intersection of a suitably aligned interval zonotope with a
sub-parallelotope can be computed exactly by a simple algebraic
formula.  Motivated by this, we specify an augmented complex zonotope
as a Minkowski sum of a template complex zonotope and an interval
zonotope.  The idea behind such a representation is that the interval
zonotope part is used to compute the intersection with a
sub-parallelotope, while the template complex zonotope may capture
positive invariance based on complex eigenstructure.  We will
mathematically formalize this idea latter.
%
\begin{definition}
Let us consider a template complex zonotope
$\tcztope{\ptemp}{\cen}{\sfact}\subseteq\compnums^n$ and an interval
zonotope $\iztope{\stemp}{\lb}{\ub}\subseteq\reals^n$.  Then the
following is the representation of an augmented complex zonotope.
%
\[
\acztope{\ptemp}{\cen}{\sfact}{\stemp}{\lb}{\ub}=\minsum{\tcztope{\ptemp}{\cen}{\sfact}}{\iztope{\stemp}{\lb}{\ub}}.
\]
%
\end{definition}
%
For deriving a formula for the intersection of an augmented complex
zonotope and a sub-parallelotope, we first derive some results about
intersection between convex sets.  Below we shall describe some
related results.

Let us define the support of a real vector $v\in\reals^n$ in a set
$S\subset\reals^n$ relative to a point $w\in\reals^n$ as
%
\[
\support{w}{v}{S}=\max_{x\in S}v^T\lt(x-w\rt).
\]
%
According to the above definition, the support of a vector $v$
relative to a point $W$ in a set $S$ gives the maximum possible
displacement along the direction of $v$ multiplied by the magnitude of
$v$.  Therefore, in the case of two closed convex sets $S_1$ and
$S_2$, to say that $S_1$ is contained in $S_2$ is equivalent to saying
that the support of all vectors relative to common point is smaller in
$S_1$ than $S_2$.  The following lemma describes this equivalence
mathematically.
%
\begin{lemma}~\label{lem:support-inclusion}
Let $S_1,S_2\subseteq \reals^n$ be two closed convex sets such that
$\intersection{S_1}{S_2}\neq \emptyset$.  Let $w\in \intersection{S_1}{S_2}$.
Then $S_1\subseteq S_2$ if and only if
%
\[
\forall
v\in\reals^n:~\support{w}{v}{S_1}\leq \support{w}{v}{S_2}.
\]
%
\end{lemma}
%
\begin{proof}
{\color{red} TO COMPLETE}.
\end{proof}
%
The support of a vector with respect to the sum of two points is
equal to the sum of supports of the vector with respect to each of the
points.  This is described in the following lemma.
%
\begin{lemma}~\label{lem:support-minsum}
Let us consider two bounded sets $S,S^\pr\subset\reals^n$ and two
vectors $w,v\in\reals^n$.  Then
%
\[
\support{w}{v}{\minsum{S}{S^\pr}}=\support{w}{v}{S}+\support{0}{v}{S^\pr}.
\]
%
\end{lemma}
%
\begin{proof}
  {\color{red} TODO}.
\end{proof}
%
The support of a vector in the intersection of two sets is the minimum
of the supports of the vector in the two sets.  This is described in
the following lemma.
%
\begin{lemma}~\label{lem:support-intersection}
Let us consider two bounded sets $S_1,S_2\subset\reals^n$ and a two
vectors $v,w\in\reals^n$.  Then
%
\[
\support{w}{v}{\intersection{S_1}{S_2}}=\min\lt(\support{w}{v}{S_1},\support{w}{v}{S_2}\rt).
\]
%
\end{lemma}
%
Recall that an augmented complex zonotope is a Minkowski sum of a
template complex zonotope and an interval zonotope, i.e.,
%
\[
\acztope{\ptemp}{\cen}{\sfact}{\stemp}{\lb}{\ub}=\minsum{\tcztope{\ptemp}{\cen}{\sfact}}{\iztope{\stemp}{\lb}{\ub}}.
\]
%
From
Lemma~\ref{lem:motivation}, we know that the intersection of a
sub-parallelotope $\ptope{\qtemp}{\plb}{\pub}$ with an interval
zonotope $\iztope{\stemp}{\lb}{\ub}$ can be computed by a simple
algebraic formula when
$\stemp=\pinv{\qtemp}$.  Based on this, we want to find a condition
under which we can over-approximate the following intersection of an
augmented complex zonotope and a sub-parallelotope
%
\begin{align*}
& \intersection{\acztope{\ptemp}{\cen}{\sfact}{\pinv{\qtemp}}{\lb}{\ub}}{\ptope{\qtemp}{\plb}{\pub}}\\
& =\intersection{\lt(\minsum{\tcztope{\ptemp}{\cen}{\sfact}}{\iztope{\pinv{\qtemp}}{\lb}{\ub}\rt)}}{\ptope{\qtemp}{\plb}{\pub}}
\end{align*}
%
by another augmented complex zonotope given as
%
\begin{align*}
& \minsum{\tcztope{\ptemp}{\cen}{\sfact}}{\intersection{\lt(\iztope{\pinv{\qtemp}}{\lb}{\ub}}{\ptope{\qtemp}{\plb}{\pub}\rt)}}\\
& =
  \minsum{\tcztope{\ptemp}{\cen}{\sfact}}{\iztope{\pinv{\qtemp}}{\join{\lb}{\plb}}{\meet{\ub}{\pub}}}\\
& = \acztope{\ptemp}{\cen}{\sfact}{\pinv{\qtemp}}{\join{\lb}{\plb}}{\meet{\ub}{\pub}},
\end{align*}
%
that is computing first the intersection (which can be done
efficiently) and then the Minkowski sum.  Indeed, we can find the
required condition for a more general case of any three closed convex
sets $S_1,S_2,S_3$, where $\lt(S_1\oplus S_2\rt)\bigcap S_3$ can be
overapproximated by $S_1\oplus\lt(S_2\bigcap S_3\rt)$. 
%
\begin{lemma}~\label{gen-int}
Let $S_1\subseteq \compnums^n$ and $S_2,S_3\in\reals^n$ be closed
convex sets such that $\intersection{S_2}{S_3}\neq \emptyset$ and $0\in S_1$.  Let
$w\in \intersection{S_2}{S_3}$ and $v\in\reals^n$.  Let 
%
\[
h = \support{w}{v}{\real\lt(S_1\rt)\oplus\lt(S_2\bigcap
  S_3\rt)}-\support{w}{v}{\lt(\real\lt(S_1\rt)\oplus S_2\rt)\bigcap
  S_3} 
\]
%
Then
%
\begin{align}
  &  \left\{
  \begin{array}{l}
   h = 0~~\text{if}~~~~~~~~\support{0}{v}{\real\lt(S_1\rt)}+\support{w}{v}{S_2}\leq
   \support{w}{v}{S_3}\\
   0\leq h \leq \support{w}{v}{\real\lt(S_1\rt)}~~\text{otherwise}.
  \end{array}
  \right.\label{eqn:support-inequality}
\end{align}
%
Consequently,
%
\begin{align}~\label{eqn:minsum-intersection}
& \intersection{\lt(S_1\oplus S_2\rt)}{S_3}\subseteq S_1\oplus\lt(\intersection{S_2}{S_3}\rt).
\end{align}
%
\end{lemma}
%
\begin{proof}
Let us
define $a = \support{0}{v}{\real\lt(S_1\rt)}$, $b=\support{w}{v}{S_2}$
and $c = \support{w}{v}{S_3}$.  
Based on Lemma~\ref{lem:support-intersection}, we get
%
\begin{align*}
& \support{w}{v}{\lt(\real\lt(S_1\rt)\oplus S_2\rt)\bigcap
  S_3}\\
& = \min\lt(\support{w}{v}{\real\lt(S_1\rt)\oplus
    S_2},\support{w}{v}{S_3}\rt).
\end{align*}
%
Next based on Lemma~\ref{lem:support-minsum}, the above equals
\begin{align*}
\min\lt(\support{0}{v}{\real\lt(S_1\rt)}+\support{w}{v}{S_2},\support{w}{v}{S_3}\rt)
= \min(a+b,c).
\end{align*}
%
  By a similar calculation, we also get
%
\[
\support{w}{v}{\real\lt(S_1\rt)\oplus\lt(S_2\cap S_3\rt)} =
a+min(b,c).  
\]
%
Therefore, 
%
\begin{align}
& h = a+min(b,c)-min(a+b,c)\nonumber\\
& = min(a+b,a+c)-min(a+b,c).\nonumber\\
& \implies \lt\{\begin{array}{l}
h=0~~\text{if}~~a+b\leq c\\
0\leq h\leq (a+c)-c = a~~\text{otherwise}.
\end{array}
\rt.
\end{align}
%
The above proves Equation~\ref{eqn:support-inequality}.

Since $h\geq0$, based on Lemma~\ref{lem:support-inclusion}, we get
%
\begin{equation}~\label{eqn:proof-support1}
\intersection{\lt(\real\lt(S_1\rt)\oplus S_2\rt)}{S_3}\subseteq \real\lt(S_1\rt)\oplus\lt(\intersection{S_2}{S_3}\rt).
\end{equation}
%
Also, since $S_2$ and $S_3$ are real sets, we have
%
\begin{align}
& \img\lt(\intersection{\lt(S_1\oplus S_2\rt)}{S_3}\rt)\\
& \%\%~\text{as}~\img\lt(S_2\rt)=\img\lt(S_3\rt)=0\nonumber\\
& = \intersection{\img\lt(S_1\rt)}{\set{0}}=\set{0}\nonumber\\
& \subseteq
\img\lt(S_1\rt)\nonumber\\
& =
\img\lt(S_1\rt)\oplus\img\lt(\intersection{S_2}{S_3}\rt)\\
& = \img\lt(S_1\oplus\lt(\intersection{S_2}{S_3}\rt)\rt).~\label{eqn:proof-support2}
\end{align}
%
Based on Equations~\ref{eqn:proof-support1} and~\ref{eqn:proof-support2}, we
get the inequality in Equation~\ref{eqn:support-inequality}.
\end{proof}
%
Now we state the main result about intersection of an augmented
complex zonotope and a suitably aligned sub-parallelotope.
%
\begin{theorem}~\label{thm:acz-ptope-intersection}
Let us consider a sub-parallelotope $\ptope{\qtemp}{\plb}{\pub}\subseteq\reals^n$ and an
augmented complex zonotope
$\acztope{\ptemp}{\cen}{\sfact}{\pinv{\qtemp}}{\lb}{\ub}\subset\compnums^n$
such that 
%
\begin{align}
& \exists z\in\compnums^n:~~\ptemp z=\cen~~\text{and}~~\absolute{z}\leq \sfact.~\label{eqn:contain-origin}
\end{align}
%
Then
%
\begin{align}
&
\intersection{\acztope{\ptemp}{\cen}{\sfact}{\pinv{\qtemp}}{\lb}{\ub}}{\ptope{\qtemp}{\plb}{\pub}}\nonumber\\
& \subseteq\acztope{\ptemp}{\cen}{\sfact}{\pinv{\qtemp}}{\join{\ub}{\pub}}{\meet{\lb}{\plb}}.~\label{eqn:thm:acz-ptope-intersection}
\end{align}
%
\end{theorem}
%
\begin{proof}
{\color{red} TODO}.
\end{proof}
%
